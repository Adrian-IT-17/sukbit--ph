<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SUKBIT - Handwoven Filipino Bags</title>

  <!-- Explicit weights so Cormorant doesn't render bold -->
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand-cream: #f6f1ea;
      --brand-brown: #9b846a;
      --bg-light: #f7efe9;
      --text-brown: #4a3a2a;
      --carousel-gap: 28; /* px */
      --arrow-gutter: 92;  /* px reserved left/right in wrapper for arrows */
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Montserrat',sans-serif;
      background:#e8ddd0;
      color:var(--text-brown);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Make sure Cormorant headings are rendered in light weight and not artificially bolded */
    .cg-display, .cg-display * {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 400;
      font-synthesis: none;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* HEADER */
    header {
      background:linear-gradient(135deg,#a89278 0%,var(--brand-brown) 100%);
      padding:15px 50px;
      position:sticky; top:0; z-index:1000;
    }
    nav{display:flex;align-items:center;justify-content:space-between;max-width:1400px;margin:0 auto}
    .logo{display:inline-flex;align-items:center;gap:6px;cursor:pointer;color:#fff}
    .logo img{height:34px;display:block;margin-right:-8px;filter:brightness(1.02) saturate(0.95);transform:translateY(-3px)}
    .logo span{font-family:'Cormorant Garamond',serif;font-weight:400;font-size:26px;color:#fff;transform:translateY(1px)}
    .nav-links{display:flex;gap:30px;list-style:none}
    .nav-links a{color:#fff;text-decoration:none;font-size:11px;font-weight:400;letter-spacing:1.2px;text-transform:uppercase}
    .nav-icons{display:flex;gap:18px;color:#fff;font-size:11px;align-items:center}
    .nav-icon{cursor:pointer;transition:all 0.3s ease;padding:8px 16px;border-radius:20px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);font-family:'Montserrat',sans-serif;font-weight:400;letter-spacing:1.2px;text-transform:uppercase;position:relative;overflow:hidden}
    .nav-icon:hover{background:rgba(255,255,255,0.2);transform:scale(1.05)}
    .nav-icon::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.5s}
    .nav-icon:hover::before{left:100%}

    /* DROPDOWN MENUS */
    .dropdown{position:relative}
    .dropdown-toggle{color:#fff;text-decoration:none;font-size:11px;font-weight:400;letter-spacing:1.2px;text-transform:uppercase;cursor:pointer;display:flex;align-items:center;gap:4px}
    .dropdown-toggle::after{content:'▼';font-size:8px;transition:transform 0.3s ease}
    .dropdown:hover .dropdown-toggle::after{transform:rotate(180deg)}
    .dropdown-menu{position:absolute;top:100%;left:0;background:#fff;min-width:200px;box-shadow:0 8px 24px rgba(0,0,0,0.15);border-radius:8px;opacity:0;visibility:hidden;transform:translateY(-10px);transition:all 0.3s ease;z-index:1000;margin-top:10px}
    .dropdown:hover .dropdown-menu{opacity:1;visibility:visible;transform:translateY(0)}
    .dropdown-menu a{display:block;padding:12px 20px;color:var(--text-brown);text-decoration:none;font-size:12px;font-family:'Montserrat',sans-serif;transition:background 0.3s ease}
    .dropdown-menu a:hover{background:var(--bg-light)}
    .dropdown-menu a:first-child{border-radius:8px 8px 0 0}
    .dropdown-menu a:last-child{border-radius:0 0 8px 8px}

    /* HERO */
    .hero{
      position:relative;
      height:85vh;
      display:flex;
      justify-content:center;
      align-items:flex-end;
      background:
        linear-gradient(to top,rgba(155,132,106,0.8),rgba(139,115,85,0.4),rgba(90,74,58,0.2)),
        url("FullSizeRender_2c0809d1-229f-4379-975c-88bead31b70b_533x.png");
      background-size:cover;
      background-position:center;
      border-bottom:5px solid #efe7e1;
      z-index:4;
    }

    .hero-content{
      width:100%;
      display:flex;
      justify-content:center;
    }

    .hero-title-wrap{
      width:100%;
      max-width:1400px;
      position:relative;
      display:flex;
      justify-content:center;
    }

    .hero-title{
      display:flex;
      align-items:flex-end;
      margin-bottom:-25px;
      position:relative;
    }

    /* BIGGER + HIGHER S */
    .s-mark{
      width:260px;
      height:280px;
      background:#fff;
      -webkit-mask-image:url('0792775b-b60a-4221-aeab-c489c138b104-removebg-preview.png');
      -webkit-mask-repeat:no-repeat;
      -webkit-mask-size:contain;
      mask-image:url('0792775b-b60a-4221-aeab-c489c138b104-removebg-preview.png');
      mask-repeat:no-repeat;
      mask-size:contain;

      transform:translateY(1px);

      margin-right:-65px;
      z-index:3;
    }

    .cg-text{
      font-size:270px;
      letter-spacing:10px;
      line-height:0.82;
      color:#fff;
            font-weight:600;
      z-index:2;
    }

    .hero-tagline{
      position:absolute;
      right:11%;
      top:6%;
      color:var(--brand-cream);
      font-size:28px;
      letter-spacing:2px;
      font-weight:600;
      white-space:nowrap;
    }

    /* ENHANCED POPUP STYLES */
    .popup-overlay{
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.7);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:2000;
      opacity:0;
      visibility:hidden;
      transition:all 0.3s ease;
    }
    .popup-overlay.active{
      opacity:1;
      visibility:visible;
    }
    .popup{
      background:#fff;
      border-radius:20px;
      max-width:900px;
      width:90%;
      max-height:90vh;
      overflow-y:auto;
      position:relative;
      transform:scale(0.9);
      transition:transform 0.3s ease;
      display:flex;
      flex-direction:column;
    }
    .popup-overlay.active .popup{
      transform:scale(1);
    }
    .popup-close{
      position:absolute;
      top:20px;
      right:20px;
      width:40px;
      height:40px;
      border-radius:50%;
      background:#f5f5f5;
      border:none;
      cursor:pointer;
      font-size:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      transition:all 0.3s ease;
      z-index:10;
    }
    .popup-close:hover{
      background:#e0e0e0;
      transform:scale(1.1);
    }
    .popup-content{
      display:flex;
      padding:0;
      flex:1;
    }
    .popup-image-section{
      flex:0 0 40%;
      background:var(--bg-light);
      border-radius:20px 0 0 20px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:40px 20px;
      position:relative;
    }
    .popup-image{
      width:100%;
      height:300px;
      background:linear-gradient(135deg,#c8d8e8 0%,#a8c8d8 100%);
      border-radius:15px;
      margin-bottom:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }
    .popup-image::before{
      content:'';
      position:absolute;
      top:20px;
      left:20px;
      width:60px;
      height:60px;
      background:var(--brand-cream);
      border-radius:50%;
      opacity:0.9;
    }
    .popup-image-actions{
      display:flex;
      flex-direction:column;
      gap:10px;
      width:100%;
    }
    .popup-action-btn{
      background:transparent;
      color:var(--brand-brown);
      border:2px solid var(--brand-brown);
      border-radius:10px;
      padding:10px 15px;
      font-family:'Montserrat',sans-serif;
      font-size:11px;
      font-weight:600;
      letter-spacing:0.5px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
    }
    .popup-action-btn:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.02);
    }
    .popup-details{
      flex:1;
      padding:40px;
      display:flex;
      flex-direction:column;
    }
    .popup-product-name{
      font-family:'Cormorant Garamond',serif;
      font-size:32px;
      color:var(--text-brown);
      margin-bottom:8px;
      font-weight:400;
    }
    .popup-price{
      font-family:'Cormorant Garamond',serif;
      font-size:36px;
      color:var(--brand-brown);
      margin-bottom:15px;
      font-weight:400;
    }
    .popup-description{
      font-family:'Montserrat',sans-serif;
      font-size:14px;
      color:#666;
      margin-bottom:30px;
      line-height:1.5;
    }
    .popup-divider{
      width:100%;
      height:1px;
      background:#e0e0e0;
      margin:20px 0;
    }
    .popup-section{
      margin-bottom:25px;
    }
    .popup-section-title{
      font-family:'Montserrat',sans-serif;
      font-size:12px;
      color:#999;
      margin-bottom:15px;
      letter-spacing:1px;
      text-transform:uppercase;
    }
    .color-selection{
      display:flex;
      gap:15px;
      margin-bottom:15px;
    }
    .color-btn{
      background:var(--brand-cream);
      border:2px solid var(--brand-brown);
      border-radius:12px;
      padding:12px 20px;
      font-family:'Montserrat',sans-serif;
      font-size:12px;
      font-weight:600;
      letter-spacing:1px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
      position:relative;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .color-btn:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.02);
    }
    .color-btn.active{
      background:var(--brand-brown);
      color:#fff;
    }
    .color-swatch{
      width:20px;
      height:20px;
      border-radius:50%;
      border:2px solid #fff;
      box-shadow:0 2px 4px rgba(0,0,0,0.2);
    }
    .color-palette{
      position:absolute;
      top:100%;
      left:0;
      margin-top:5px;
      background:#fff;
      border:2px solid var(--brand-brown);
      border-radius:15px;
      padding:15px;
      display:none;
      grid-template-columns:repeat(6,1fr);
      gap:10px;
      box-shadow:0 5px 15px rgba(0,0,0,0.2);
      z-index:5;
      max-width:360px;
      max-height:220px;
      overflow:auto;
    }
    .color-palette.active{
      display:grid;
    }
    .color-option{
      width:40px;
      height:40px;
      border-radius:50%;
      cursor:pointer;
      border:2px solid transparent;
      transition:all 0.3s ease;
    }
    .color-option:hover{
      transform:scale(1.1);
      border-color:var(--brand-brown);
    }
    .color-option.selected{
      border-color:var(--brand-brown);
      box-shadow:0 0 0 3px rgba(155,132,106,0.3);
    }
    .color-input{
      width:40px;
      height:40px;
      padding:0;
      border:0;
      border-radius:50%;
      cursor:pointer;
      background:transparent;
    }
    .size-selection{
      display:flex;
      gap:10px;
    }
    .size-btn{
      background:var(--brand-cream);
      border:2px solid var(--brand-brown);
      border-radius:10px;
      padding:10px 20px;
      font-family:'Montserrat',sans-serif;
      font-size:12px;
      font-weight:600;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
    }
    .size-btn:hover{
      background:var(--brand-brown);
      color:#fff;
    }
    .size-btn.active{
      background:var(--brand-brown);
      color:#fff;
    }
    .quantity-selector{
      display:flex;
      align-items:center;
      gap:20px;
    }
    .quantity-btn{
      width:45px;
      height:45px;
      border-radius:50%;
      border:2px solid var(--brand-brown);
      background:transparent;
      color:var(--brand-brown);
      font-size:20px;
      cursor:pointer;
      transition:all 0.3s ease;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .quantity-btn:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.1);
    }
    .quantity-display{
      font-family:'Montserrat',sans-serif;
      font-size:18px;
      font-weight:600;
      min-width:30px;
      text-align:center;
      color:var(--text-brown);
    }
    .popup-preorder-btn{
      background:var(--brand-brown);
      color:#fff;
      border:none;
      border-radius:15px;
      padding:18px 40px;
      font-family:'Montserrat',sans-serif;
      font-size:16px;
      font-weight:600;
      letter-spacing:1px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
      margin-top:20px;
    }
    .popup-preorder-btn:hover{
      background:#8a735a;
      transform:scale(1.02);
    }
    .popup-preorder-btn:active{
      transform:scale(0.98);
    }

    /* PREMIUM SHOP SECTIONS - NICE BUT NOT AS GRAND AS PREORDER */
    .shop-hand,.shop-special,.shop-limited{padding:60px 50px;text-align:center;position:relative}
    .shop-hand{background:linear-gradient(135deg,var(--brand-cream) 0%,#f6f1ea 100%)}
    .shop-special{background:linear-gradient(135deg,#efe7e1 0%,#e8ddd0 100%)}
    .shop-limited{background:linear-gradient(135deg,#f7efe9 0%,#efe7e1 100%)}
    .shop-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:35px;max-width:1400px;margin:0 auto;position:relative}
    .shop-item{background:linear-gradient(145deg,#fff 0%,var(--brand-cream) 100%);padding:25px;border-radius:12px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 6px 20px rgba(0,0,0,0.08),0 2px 6px rgba(0,0,0,0.04);position:relative;overflow:hidden;border:1px solid rgba(155,132,106,0.15);display:flex;flex-direction:column;height:100%}
    .shop-item::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--brand-brown),#a89278,var(--brand-brown))}
    .shop-item:hover{transform:translateY(-8px) scale(1.01);box-shadow:0 12px 30px rgba(0,0,0,0.12),0 4px 12px rgba(0,0,0,0.08)}
    .shop-img{width:100%;aspect-ratio:1;background-size:cover;background-position:center;border-radius:10px;margin-bottom:18px;position:relative;overflow:hidden}
    .shop-item h3{font-size:17px;color:var(--text-brown);margin-bottom:10px;font-weight:600;letter-spacing:0.3px;text-transform:uppercase}
    .shop-item p{font-size:12px;color:var(--text-brown);margin-bottom:12px;line-height:1.5;font-weight:400;opacity:0.85;display:-webkit-box;line-clamp:3;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;min-height:54px}
    .shop-item .price{margin-top:auto}
    .shop-btn{background:linear-gradient(135deg,var(--brand-brown) 0%,#8a735a 100%);color:#fff;border:none;padding:12px 24px;border-radius:25px;font-weight:600;letter-spacing:1px;cursor:pointer;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);text-transform:uppercase;font-size:11px;box-shadow:0 3px 10px rgba(155,132,106,0.3);position:relative;overflow:hidden}
    .shop-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.15),transparent);transition:left 0.4s}
    .shop-btn:hover{background:linear-gradient(135deg,#8a735a 0%,var(--brand-brown) 100%);transform:scale(1.03);box-shadow:0 6px 18px rgba(155,132,106,0.4)}
    .shop-btn:hover::before{left:100%}

    /* Shop Carousel Navigation */
    .shop-carousel-btn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:40px;height:40px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,0.95);color:var(--brand-brown);
      border:2px solid var(--brand-brown);box-shadow:0 3px 12px rgba(0,0,0,0.15);z-index:100;cursor:pointer;
      transition:all 0.3s ease;
      font-size:18px;
      font-weight:bold;
    }
    .shop-carousel-btn:hover{background:#fff;box-shadow:0 5px 18px rgba(0,0,0,0.25);transform:translateY(-50%) scale(1.05);border-color:var(--text-brown)}
    .shop-carousel-btn.prev{ left: 10px; }
    .shop-carousel-btn.next{ right: 10px; }

    /* Shop Carousel Wrapper */
    .shop-carousel-wrapper{position:relative;overflow:hidden;margin:0 -10px}
    .shop-carousel-track{display:flex;gap:20px;transition:transform 0.5s cubic-bezier(.22,.9,.36,1);will-change:transform}
    .shop-slide{flex:0 0 auto;width:calc(25% - 15px)}

    /* 2-ROW ON-HAND LAYOUT */
    .shop-carousel-track.two-rows{align-items:flex-start}
    .shop-carousel-track.two-rows .shop-col{flex:0 0 auto;width:calc(25% - 26px);display:flex;flex-direction:column;gap:35px}
    .shop-carousel-track.two-rows .shop-slide{width:100%}

    /* PREMIUM PRODUCTS SECTION */
    .products{background:linear-gradient(135deg,var(--brand-brown) 0%,#8a735a 50%,var(--brand-brown) 100%);padding:60px 40px;text-align:center;position:relative}
    .products::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,rgba(246,241,234,0.08) 0%,rgba(246,241,234,0.03) 100%);pointer-events:none}
    .products h2{font-family:'Cormorant Garamond',serif;font-weight:300;font-size:38px;color:#fff;margin-bottom:16px;text-shadow:0 1px 3px rgba(0,0,0,0.2);letter-spacing:1.5px}
    .products-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:30px;max-width:1400px;margin:0 auto;position:relative;z-index:1}
    .product{background:linear-gradient(145deg,var(--brand-cream) 0%,#fff 100%);padding:20px;border-radius:12px;transition:all 0.4s cubic-bezier(0.4,0,0.2,1);box-shadow:0 4px 15px rgba(0,0,0,0.1),0 1px 4px rgba(0,0,0,0.05);position:relative;overflow:hidden;border:1px solid rgba(155,132,106,0.2);cursor:pointer;display:flex;flex-direction:column;height:100%}
    .product::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--text-brown),var(--brand-brown),var(--text-brown))}
    .product::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:linear-gradient(45deg,transparent 30%,rgba(255,255,255,0.1) 50%,transparent 70%);transform:rotate(45deg);transition:all 0.6s;opacity:0}
    .product:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 12px 35px rgba(0,0,0,0.2),0 4px 12px rgba(0,0,0,0.1)}
    .product:hover::after{top:-100%;left:-100%;opacity:1}
    .product-img{width:100%;height:180px;background:linear-gradient(135deg,var(--brand-cream) 0%,#f6f1ea 100%);border-radius:8px;margin-bottom:16px;position:relative;overflow:hidden;transition:all 0.4s ease}
    .product-img::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:40px;height:40px;background:var(--brand-brown);border-radius:50%;opacity:0.1;transition:all 0.4s ease}
    .product:hover .product-img{transform:scale(1.05)}
    .product:hover .product-img::after{opacity:0.2;transform:translate(-50%,-50%) scale(1.2)}
    .product h3{font-size:16px;color:var(--text-brown);margin-bottom:8px;font-weight:500;letter-spacing:0.3px;text-transform:uppercase}
    .product p{font-size:12px;color:var(--text-brown);margin-bottom:10px;line-height:1.4;font-weight:400;opacity:0.85;display:-webkit-box;line-clamp:2;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:34px}
    .product .price{margin-top:auto}
    .price{font-size:18px;font-weight:600;color:var(--brand-brown);margin-bottom:14px;letter-spacing:0.5px}
    .preorder-btn{
      background:linear-gradient(135deg,var(--text-brown) 0%,var(--brand-brown) 100%);
      color:#fff;
      border:none;
      padding:10px 20px;
      border-radius:20px;
      font-weight:500;
      font-size:11px;
      letter-spacing:1px;
      cursor:pointer;
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      text-transform:uppercase;
      position:relative;
      overflow:hidden;
      box-shadow:0 2px 8px rgba(0,0,0,0.1)
    }
    .preorder-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.2),transparent);transition:left 0.5s}
    .preorder-btn:hover{transform:scale(1.05);box-shadow:0 4px 15px rgba(0,0,0,0.2)}
    .preorder-btn:hover::before{left:100%}

    /* FEATURES */
    .features{padding:70px 60px;text-align:center;background:#efe7e1}
    .features h2{font-family:'Cormorant Garamond',serif;font-weight:400;font-size:32px;margin-bottom:45px;color:var(--text-brown)}
    .features-grid{display:flex;justify-content:center;gap:80px;margin-bottom:35px}
    .features-grid h3{font-family:'Cormorant Garamond',serif;font-weight:400;letter-spacing:2px;color:var(--text-brown);text-transform:uppercase}
    .features p{font-size:14px;color:#6b5a45;letter-spacing:1px;text-transform:uppercase;font-family:'Montserrat',sans-serif;max-width:600px;margin:0 auto}

    /* CATEGORIES - SUKBIT INSPIRED */
    .categories{background:#fff;padding:0;position:relative}
    .categories-container{display:flex;align-items:stretch;min-height:450px;max-width:1400px;margin:0 auto;padding:0;gap:0}
    .categories-sidebar{width:100px;display:flex;align-items:center;justify-content:center;padding:10px 0;background:var(--brand-brown);position:relative}
    .categories-sidebar::after{content:'';position:absolute;right:0;top:0;bottom:0;width:1px;background:rgba(246,241,234,0.2)}
    .categories-title{writing-mode:vertical-rl;transform:rotate(180deg);font-family:'Cormorant Garamond',serif;font-weight:300;font-size:20px;letter-spacing:4px;padding:10px 0;border:none;color:var(--brand-cream);text-align:center}
    .categories-right{flex:1;display:flex;flex-direction:column;background:#fff;position:relative}
    .categories-top-bar{display:none}
    .categories-main{display:flex;gap:30px;align-items:center;padding:20px 30px;background:#fff}
    .categories-desc-area{display:flex;flex-direction:column;gap:8px;min-width:150px}
    .categories-desc{font-size:11px;letter-spacing:1.5px;color:var(--text-brown);font-family:'Montserrat',sans-serif;text-transform:uppercase;font-weight:500;opacity:0.8}
    .categories-arrow{font-size:28px;color:var(--brand-brown);transform:translateX(2px);margin-top:-2px;opacity:0.7}

    /* Enhanced carousel styling */
    .categories-images-wrapper{
      flex:1;
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      min-width:0;
      padding: 0;
    }

    .categories-images{
      display:flex;
      gap: calc(var(--carousel-gap) * 1px);
      transition: transform .5s cubic-bezier(.22,.9,.36,1);
      will-change: transform;
      align-items:center;
      width:100%;
    }

    .slide{flex:0 0 auto;display:flex;justify-content:center;align-items:center;overflow:hidden;width:calc(48% - 20px)}
    .cat-img{width:100%;height:380px;border:none;background:linear-gradient(180deg,var(--brand-cream) 0%,#f6f1ea 100%);box-sizing:border-box;overflow:hidden;border-radius:4px;transition:all 0.3s ease;cursor:pointer;position:relative}
    .cat-img:hover{box-shadow:0 4px 15px rgba(155,132,106,0.15)}
    .cat-img img{width:100%;height:100%;object-fit:contain;display:block}

    .carousel-btn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:40px;height:40px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,0.95);color:var(--brand-brown);
      border:none;box-shadow:0 2px 8px rgba(0,0,0,0.1);z-index:6;cursor:pointer;
      transition:all 0.3s ease;
    }
    .carousel-btn:hover{background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.15);transform:translateY(-50%) scale(1.05)}
    .carousel-btn.prev{ left: 25px; }
    .carousel-btn.next{ right: 25px; }

    .categories-bottom-bar{display:none}

    /* PREMIUM CUSTOMIZATION SECTION */
    .custom{
      height:440px;
      background:linear-gradient(135deg,var(--brand-brown) 0%,#8a735a 50%,var(--brand-brown) 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      padding:60px 40px;
      overflow:hidden
    }
    .custom::before{
      content:'';
      position:absolute;
      inset:0;
      background:linear-gradient(135deg,rgba(246,241,234,0.08) 0%,rgba(246,241,234,0.03) 100%);
      pointer-events:none
    }
    .custom-content{
      position:relative;z-index:2;
      text-align:center;color:#fff;
      max-width:900px;
      padding:30px;
      background:rgba(255,255,255,0.05);
      backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,0.1);
      border-radius:12px;
      box-shadow:0 4px 20px rgba(0,0,0,0.2)
    }
    .custom-content h2{
      margin-bottom:12px;
      font-family:'Cormorant Garamond',serif;
      font-weight:300;
      font-size:36px;
      letter-spacing:1.5px;
      color:#fff;
      text-shadow:0 1px 3px rgba(0,0,0,0.2)
    }
    .custom-content p{
      margin-bottom:25px;
      font-size:16px;
      line-height:1.5;
      color:rgba(255,255,255,0.9);
      font-weight:300;
      max-width:600px;
      margin-left:auto;
      margin-right:auto
    }
    .btn-custom{
      background:linear-gradient(135deg,var(--brand-cream) 0%,#fff 100%);
      color:var(--text-brown);
      padding:14px 35px;
      border-radius:25px;
      border:none;
      font-weight:600;
      font-size:13px;
      transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
      cursor:pointer;
      font-family:'Montserrat',sans-serif;
      letter-spacing:1px;
      text-transform:uppercase;
      box-shadow:0 3px 10px rgba(0,0,0,0.2);
      position:relative;
      overflow:hidden
    }
    .btn-custom::before{
      content:'';
      position:absolute;
      top:0;left:-100%;
      width:100%;height:100%;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
      transition:left 0.4s ease
    }
    .btn-custom:hover{
      background:linear-gradient(135deg,#fff 0%,#f6f1ea 100%);
      color:var(--brand-brown);
      transform:scale(1.02);
      box-shadow:0 5px 15px rgba(0,0,0,0.3)
    }
    .btn-custom:hover::before{
      left:100%
    }

    /* REVIEWS (restyled to match prototype) */
    .reviews{padding:70px 60px;text-align:center;background:#efe7e1}
    .reviews h2{font-family:'Cormorant Garamond',serif;font-weight:400;font-size:34px;color:var(--text-brown);margin-bottom:40px}
    .reviews-carousel{max-width:900px;margin:0 auto;position:relative;display:flex;align-items:center;gap:25px}
    .reviews-track{overflow:hidden;width:100%}
    .reviews-list{display:flex;gap:24px;transition:transform .45s cubic-bezier(.22,.9,.36,1);will-change:transform}
    .review-slide{flex:0 0 100%;display:flex;justify-content:center}
    .review-card{width:100%;max-width:680px;background:#8b7355;color:#fff;padding:36px 32px;border-radius:15px;border:3px solid #4a3a2a;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:260px;position:relative}
    .review-avatar{width:70px;height:70px;border-radius:50%;background:#ebe5df;margin-bottom:18px}
    .review-name{font-family:'Montserrat',sans-serif;font-weight:600;font-size:18px;margin-bottom:12px;color:#fff}
    .review-line{width:60px;height:3px;background:#4a3a2a;margin-bottom:10px;border-radius:2px}
    .review-text{font-size:15px;line-height:1.5;color:#fff;max-width:560px;text-align:center}
    .review-rating{display:flex;gap:5px;margin-bottom:15px;font-size:18px;color:#ffd700}
    .review-date{font-size:12px;color:rgba(255,255,255,0.7);margin-top:10px;font-family:'Montserrat',sans-serif}
    .review-verified{display:inline-flex;align-items:center;gap:5px;background:rgba(255,255,255,0.2);padding:4px 8px;border-radius:12px;font-size:11px;color:#fff;margin-top:8px}
    .review-verified::before{content:'✓';font-weight:bold}
    .reviews-btn{position:absolute;top:50%;transform:translateY(-50%);width:42px;height:42px;border-radius:50%;background:rgba(255,255,255,0.95);border:none;box-shadow:0 2px6px rgba(0,0,0,0.12);z-index:6;cursor:pointer;color:var(--text-brown);transition:all 0.3s ease}
    .reviews-btn:hover{background:#fff;transform:translateY(-50%) scale(1.1)}
    .reviews-btn.prev{left:-6px}
    .reviews-btn.next{right:-6px}
    .reviews-dots{display:flex;justify-content:center;gap:10px;margin-top:18px}
    .reviews-dot{width:10px;height:10px;border-radius:50%;background:#b5a393;cursor:pointer;transition:all 0.3s ease}
    .reviews-dot:hover{background:var(--brand-brown)}
    .reviews-dot.active{background:#4a3a2a}

    /* Back to Top Button */
    .back-to-top{
      position:fixed;
      bottom:30px;
      right:30px;
      width:50px;
      height:50px;
      background:linear-gradient(135deg,var(--brand-brown) 0%,#8a735a 100%);
      color:#fff;
      border:none;
      border-radius:50%;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      opacity:0;
      visibility:hidden;
      transition:all 0.3s ease;
      z-index:1000;
      box-shadow:0 4px 15px rgba(0,0,0,0.2)
    }
    .back-to-top.show{
      opacity:1;
      visibility:visible
    }
    .back-to-top:hover{
      transform:scale(1.1);
      background:linear-gradient(135deg,var(--text-brown) 0%,var(--brand-brown) 100%)
    }
    .leave-review-section{margin-top:50px;text-align:center}
    .leave-review-btn{background:var(--brand-brown);color:#fff;border:none;padding:15px 30px;border-radius:8px;font-family:'Montserrat',sans-serif;font-weight:600;font-size:14px;cursor:pointer;transition:all 0.3s ease;text-transform:uppercase;letter-spacing:1px}
    .leave-review-btn:hover{background:#8a735a;transform:scale(1.02)}

    /* Review Modal */
    .review-modal{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.8);
      z-index:9999;
      display:none;
      align-items:flex-start;
      justify-content:center;
      backdrop-filter:blur(5px);
      overflow-y:auto;
      padding:40px 0
    }
    .review-modal.active{display:flex}
    .review-content{
      background:#fff;
      border-radius:20px;
      padding:40px;
      max-width:600px;
      width:90%;
      position:relative;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      margin:0 auto;
      max-height:calc(100vh - 80px);
      overflow-y:auto
    }
    .review-close{
      position:absolute;
      top:20px;right:20px;
      width:40px;height:40px;
      border-radius:50%;
      background:var(--brand-cream);
      border:none;
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-size:24px;
      color:var(--text-brown);
      transition:all 0.3s ease
    }
    .review-close:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.1)
    }
    .review-title{
      font-family:'Cormorant Garamond',serif;
      font-size:32px;
      color:var(--text-brown);
      margin-bottom:30px;
      text-align:center
    }
    .review-form-group{
      margin-bottom:20px
    }
    .review-form-label{
      display:block;
      margin-bottom:8px;
      font-family:'Montserrat',sans-serif;
      font-weight:500;
      color:var(--text-brown);
      font-size:14px
    }
    .review-form-input, .review-form-textarea{
      width:100%;
      padding:12px 15px;
      border:2px solid var(--brand-cream);
      border-radius:8px;
      font-family:'Montserrat',sans-serif;
      font-size:14px;
      outline:none;
      transition:all 0.3s ease;
      box-sizing:border-box
    }
    .review-form-textarea{
      min-height:120px;
      resize:vertical
    }
    .review-form-input:focus, .review-form-textarea:focus{
      border-color:var(--brand-brown);
      box-shadow:0 0 0 3px rgba(155,132,106,0.1)
    }
    .review-rating-input{
      display:flex;
      gap:10px;
      justify-content:center;
      margin-bottom:20px
    }
    .review-star{
      font-size:30px;
      color:var(--brand-cream);
      cursor:pointer;
      transition:all 0.3s ease
    }
    .review-star:hover, .review-star.active{
      color:#ffd700;
      transform:scale(1.1)
    }
    .review-submit{
      width:100%;
      background:var(--brand-brown);
      color:#fff;
      border:none;
      padding:15px;
      border-radius:8px;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      font-size:14px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
      letter-spacing:1px
    }
    .review-submit:hover{
      background:#8a735a;
      transform:scale(1.02)
    }

    /* INSTAGRAM */
    .instagram{background:#b5a393;padding:48px 60px;text-align:center;position:relative}
    .instagram h2{font-family:'Cormorant Garamond',serif;font-weight:400;font-size:34px;color:var(--text-brown);margin-bottom:6px}
    .instagram p{margin-top:-12px;margin-bottom:18px;color:var(--text-brown);font-family:'Montserrat',sans-serif}
    .ig-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;max-width:1200px;margin:0 auto}
    .ig{height:220px;background:#a89278;overflow:hidden;cursor:pointer}
    .ig img{width:100%;height:100%;object-fit:cover;display:block}

    /* FOOTER */
    footer{background:#5a4a3a;color:#d4c4b0;padding:36px 40px 28px}
    .footer-logo{text-align:center;margin-bottom:28px}
    .footer-logo-text{display:flex;align-items:center;justify-content:center;gap:6px;font-family:'Cormorant Garamond',serif;font-weight:400;font-size:20px;color:#fff}
    .footer-logo-text img{height:26px;margin-right:-6px;filter:brightness(1.02) saturate(0.95);transform:translateY(-3px)}
    .footer-logo-text span{transform:translateY(1px)}
    .footer-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:40px;max-width:1300px;margin:0 auto}
    footer h4{color:#fff;font-size:13px;font-weight:700;margin-bottom:16px;font-family:'Montserrat',sans-serif}
    footer li,footer p{font-size:11px;line-height:1.5;margin-bottom:10px;font-family:'Montserrat',sans-serif}
    footer ul{padding:0}
    footer a{color:#d4c4b0;text-decoration:none}
    .newsletter-form{display:flex;margin-top:10px}
    input{flex:1;padding:10px 13px;border:none;background:#6f5b48;color:#fff;font-size:11px;font-family:'Montserrat',sans-serif}
    input::placeholder{color:#a89278}
    .newsletter-form button{padding:10px 20px;background:#8b7355;color:#fff;border:none;font-size:14px;cursor:pointer;font-family:'Montserrat',sans-serif}

    /* ACCOUNT MODAL */
    .account-modal{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.8);
      z-index:9999;
      display:none;
      align-items:center;
      justify-content:center;
      backdrop-filter:blur(5px)
    }
    .account-modal.active{display:flex}
    .account-content{
      background:#fff;
      border-radius:20px;
      padding:40px;
      max-width:550px;
      width:90%;
      max-height:85vh;
      overflow-y:auto;
      position:relative;
      box-shadow:0 20px 60px rgba(0,0,0,0.3)
    }
    .account-close{
      position:absolute;
      top:20px;right:20px;
      width:40px;height:40px;
      border-radius:50%;
      background:var(--brand-cream);
      border:none;
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-size:24px;
      color:var(--text-brown);
      transition:all 0.3s ease
    }
    .account-close:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.1)
    }
    .account-title{
      font-family:'Cormorant Garamond',serif;
      font-size:32px;
      color:var(--text-brown);
      margin-bottom:30px;
      text-align:center
    }
    .account-tabs{
      display:flex;
      gap:10px;
      margin-bottom:30px;
      border-bottom:2px solid var(--brand-cream)
    }
    .account-tab{
      flex:1;
      padding:12px;
      background:none;
      border:none;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      color:var(--text-brown);
      cursor:pointer;
      transition:all 0.3s ease;
      border-bottom:3px solid transparent
    }
    .account-tab.active{
      border-bottom-color:var(--brand-brown);
      color:var(--brand-brown)
    }
    .account-tab:hover{
      color:var(--brand-brown)
    }
    .cart-continue:hover {
      color: var(--text-brown);
    }

    /* CART NOTIFICATIONS */
    .cart-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #9b846a, #b5a393);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      z-index: 10000;
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      max-width: 300px;
      animation: slideIn 0.3s ease-out;
    }
    
    .notification-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .notification-item {
      font-weight: 600;
      flex: 1;
    }
    
    .notification-quantity {
      background: rgba(255,255,255,0.2);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 12px;
      margin: 0 8px;
    }
    
    .notification-price {
      font-weight: 600;
    }
    
    .notification-total {
      font-size: 12px;
      opacity: 0.9;
      border-top: 1px solid rgba(255,255,255,0.2);
      padding-top: 8px;
    }
    
    .preorder-notification .notification-total {
      color: #f6f1ea;
      font-weight: 600;
    }
    
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    .account-form{
      display:none
    }
    .account-form.active{display:block}
    .form-group{
      margin-bottom:20px
    }
    .form-label{
      display:block;
      margin-bottom:8px;
      font-family:'Montserrat',sans-serif;
      font-weight:500;
      color:var(--text-brown);
      font-size:14px
    }
    .form-input{
      width:100%;
      padding:12px 15px;
      border:2px solid var(--brand-cream);
      border-radius:8px;
      font-family:'Montserrat',sans-serif;
      font-size:14px;
      outline:none;
      transition:all 0.3s ease
    }
    .form-input:focus{
      border-color:var(--brand-brown);
      box-shadow:0 0 0 3px rgba(155,132,106,0.1)
    }
    .form-checkbox{
      display:flex;
      align-items:center;
      gap:10px;
      margin-bottom:20px
    }
    .form-checkbox input{
      width:18px;height:18px;
      accent-color:var(--brand-brown)
    }
    .form-checkbox label{
      font-family:'Montserrat',sans-serif;
      font-size:14px;
      color:var(--text-brown)
    }
    .form-submit{
      width:100%;
      background:var(--brand-brown);
      color:#fff;
      border:none;
      padding:15px;
      border-radius:8px;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      font-size:14px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
      letter-spacing:1px
    }
    .form-submit:hover{
      background:#8a735a;
      transform:scale(1.02)
    }
    .account-links{
      text-align:center;
      margin-top:20px
    }
    .account-links a{
      color:var(--brand-brown);
      text-decoration:none;
      font-family:'Montserrat',sans-serif;
      font-size:13px;
      margin:0 10px
    }
    .account-links a:hover{
      text-decoration:underline
    }

    /* CART MODAL */
    .cart-modal{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.8);
      z-index:9999;
      display:none;
      align-items:center;
      justify-content:center;
      backdrop-filter:blur(5px)
    }
    .cart-modal.active{display:flex}
    .cart-content{
      background:#fff;
      border-radius:20px;
      padding:40px;
      max-width:600px;
      width:90%;
      position:relative;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      max-height:80vh;
      overflow-y:auto
    }
    .cart-close{
      position:absolute;
      top:20px;right:20px;
      width:40px;height:40px;
      border-radius:50%;
      background:var(--brand-cream);
      border:none;
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-size:24px;
      color:var(--text-brown);
      transition:all 0.3s ease
    }
    .cart-close:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.1)
    }
    .cart-title{
      font-family:'Cormorant Garamond',serif;
      font-size:32px;
      color:var(--text-brown);
      margin-bottom:30px;
      text-align:center
    }
    .cart-empty{
      text-align:center;
      padding:40px;
      color:var(--text-brown);
      font-family:'Montserrat',sans-serif
    }
    .cart-item{
      display:flex;
      gap:20px;
      padding:20px;
      border-bottom:1px solid var(--brand-cream);
      align-items:center
    }
    .cart-item:last-child{border-bottom:none}
    .cart-item-image{
      width:80px;height:80px;
      background:var(--brand-cream);
      border-radius:8px;
      flex-shrink:0
    }
    .cart-item-details{
      flex:1
    }
    .cart-item-name{
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      color:var(--text-brown);
      margin-bottom:5px
    }
    .cart-item-desc{
      font-family:'Montserrat',sans-serif;
      font-size:13px;
      color:#6b5a45;
      margin-bottom:8px
    }
    .cart-item-price{
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      color:var(--brand-brown)
    }
    .cart-item-quantity{
      display:flex;
      align-items:center;
      gap:10px;
      margin-top:10px
    }
    .cart-quantity-btn{
      width:30px;height:30px;
      border-radius:50%;
      border:2px solid var(--brand-brown);
      background:transparent;
      color:var(--brand-brown);
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-weight:600;
      transition:all 0.3s ease
    }
    .cart-quantity-btn:hover{
      background:var(--brand-brown);
      color:#fff
    }
    .cart-quantity-display{
      min-width:30px;
      text-align:center;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      color:var(--text-brown)
    }
    .cart-item-remove{
      background:transparent;
      border:none;
      color:#dc3545;
      cursor:pointer;
      font-family:'Montserrat',sans-serif;
      font-size:12px;
      padding:5px 10px;
      border-radius:5px;
      transition:all 0.3s ease
    }
    .cart-item-remove:hover{
      background:#dc3545;
      color:#fff
    }
    .cart-summary{
      margin-top:30px;
      padding-top:20px;
      border-top:2px solid var(--brand-cream)
    }
    .cart-total{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:20px;
      font-family:'Montserrat',sans-serif;
      font-size:18px;
      font-weight:600;
      color:var(--text-brown)
    }
    .cart-checkout{
      width:100%;
      background:var(--brand-brown);
      color:#fff;
      border:none;
      padding:15px;
      border-radius:8px;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      font-size:16px;
      cursor:pointer;
      transition:all 0.3s ease;
      text-transform:uppercase;
      letter-spacing:1px
    }
    .cart-checkout:hover{
      background:#8a735a;
      transform:scale(1.02)
    }
    .cart-continue{
      display:block;
      text-align:center;
      margin-top:15px;
      color:var(--brand-brown);
      text-decoration:none;
      font-family:'Montserrat',sans-serif;
      font-size:14px
    }
    .cart-continue:hover{
      text-decoration:underline
    }

    /* SEARCH MODAL */
    .search-modal{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.8);
      z-index:9999;
      display:none;
      align-items:center;
      justify-content:center;
      backdrop-filter:blur(5px)
    }
    .search-modal.active{display:flex}
    .search-content{
      background:#fff;
      border-radius:20px;
      padding:40px;
      max-width:600px;
      width:90%;
      position:relative;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      max-height:85vh;
      overflow:hidden;
      display:flex;
      flex-direction:column
    }
    .search-close{
      position:absolute;
      top:20px;right:20px;
      width:40px;height:40px;
      border-radius:50%;
      background:var(--brand-cream);
      border:none;
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-size:24px;
      color:var(--text-brown);
      transition:all 0.3s ease
    }
    .search-close:hover{
      background:var(--brand-brown);
      color:#fff;
      transform:scale(1.1)
    }
    .search-title{
      font-family:'Cormorant Garamond',serif;
      font-size:32px;
      color:var(--text-brown);
      margin-bottom:20px;
      text-align:center
    }
    .search-input-wrapper{
      position:relative;
      margin-bottom:30px
    }
    .search-input{
      width:100%;
      padding:15px 50px 15px 20px;
      border:2px solid var(--brand-cream);
      border-radius:10px;
      font-size:16px;
      font-family:'Montserrat',sans-serif;
      outline:none;
      transition:all 0.3s ease
    }
    .search-input:focus{
      border-color:var(--brand-brown);
      box-shadow:0 0 0 3px rgba(155,132,106,0.1)
    }
    .search-btn{
      position:absolute;
      right:5px;top:50%;
      transform:translateY(-50%);
      background:var(--brand-brown);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:10px 15px;
      cursor:pointer;
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      text-transform:uppercase;
      font-size:12px;
      letter-spacing:1px;
      transition:all 0.3s ease
    }
    .search-btn:hover{
      background:#8a735a;
      transform:translateY(-50%) scale(1.05)
    }
    .search-results{
      flex:1;
      min-height:0;
      overflow-y:auto
    }
    .search-no-results{
      padding:20px;
      text-align:center;
      color:var(--text-brown);
      font-family:'Montserrat',sans-serif
    }
    .search-no-results p:first-child{
      font-weight:600;
      margin-bottom:10px;
      font-size:16px
    }
    .search-no-results p:last-child{
      font-size:14px;
      color:#666;
      line-height:1.5
    }
    .search-results-list{
      max-height:400px;
      overflow-y:auto;
      margin-top:15px
    }
    .search-result-item{
      display:flex;
      align-items:center;
      padding:12px;
      border-radius:8px;
      margin-bottom:8px;
      background:var(--bg-light);
      cursor:pointer;
      transition:all 0.3s ease
    }
    .search-result-item:hover{
      background:var(--brand-cream);
      transform:translateX(4px)
    }
    .search-result-img{
      width:60px;
      height:60px;
      border-radius:6px;
      background-size:cover;
      background-position:center;
      margin-right:12px;
      background-color:var(--brand-cream)
    }
    .search-result-info{
      flex:1
    }
    .search-result-info h4{
      font-size:14px;
      color:var(--text-brown);
      margin-bottom:4px;
      font-weight:600
    }
    .search-result-desc{
      font-size:12px;
      color:var(--text-brown);
      opacity:0.7;
      margin-bottom:6px;
      line-height:1.3
    }
    .search-result-meta{
      display:flex;
      justify-content:space-between;
      align-items:center
    }
    .search-result-price{
      font-size:13px;
      color:var(--brand-brown);
      font-weight:600
    }
    .search-result-category{
      font-size:11px;
      color:var(--text-brown);
      opacity:0.6;
      text-transform:uppercase
    }
    .search-no-results{
      text-align:center;
      padding:20px;
      color:var(--text-brown);
      opacity:0.7
    }
    .search-view-all{
      text-align:center;
      padding:10px;
      margin-top:10px
    }
    .search-view-all-link{
      color:var(--brand-brown);
      text-decoration:none;
      font-weight:600;
      transition:all 0.3s ease
    }
    .search-view-all-link:hover{
      color:var(--text-brown)
    }
    .search-result-category{
      font-family:'Montserrat',sans-serif;
      font-size:12px;
      color:var(--brand-brown);
      background:var(--brand-cream);
      padding:4px 8px;
      border-radius:12px
    }
    .search-result-price{
      font-family:'Montserrat',sans-serif;
      font-weight:600;
      color:var(--brand-brown)
    }
    .search-result-colors{
      display:flex;
      gap:6px;
      flex-wrap:wrap
    }
    .color-tag{
      font-family:'Montserrat',sans-serif;
      font-size:11px;
      color:#666;
      background:#f0f0f0;
      padding:3px 8px;
      border-radius:10px;
      border:1px solid #ddd
    }
    .search-categories{
      display:flex;
      gap:10px;
      margin-bottom:20px;
      flex-wrap:wrap
    }
    .search-category{
      background:var(--brand-cream);
      color:var(--text-brown);
      padding:8px 15px;
      border-radius:20px;
      font-size:12px;
      font-family:'Montserrat',sans-serif;
      font-weight:500;
      cursor:pointer;
      transition:all 0.3s ease;
      border:1px solid transparent
    }
    .search-category:hover{
      background:var(--brand-brown);
      color:#fff;
      border-color:var(--brand-brown)
    }

    /* Responsive */
    @media (max-width:1024px){
      .hero-title .s-mark{width:160px;height:160px;transform:scaleY(0.95) translateY(14px) translateX(18px); margin-right:-56px}
      .hero-title .cg-text{font-size:160px}
      .products-grid{grid-template-columns:repeat(2,1fr)}
      .shop-grid{grid-template-columns:repeat(2,1fr)}
      .categories-container{flex-direction:column;padding:20px;min-height:auto}
      .categories-title{writing-mode:horizontal-tb;transform:none;padding:6px 10px;font-size:20px}
      .ig-grid{grid-template-columns:repeat(2,1fr)}
      .footer-grid{grid-template-columns:repeat(2,1fr)}
      .custom{height:400px;padding:40px 30px}
      .custom-content{padding:25px}
      .custom-content h2{font-size:32px}
      .custom-content p{font-size:15px}
      .btn-custom{padding:12px 30px;font-size:12px}
    }
    @media (max-width:768px){
      .nav-links{display:none}
      .hero-bags{display:none}
      .hero-title .s-mark{width:90px;height:90px;transform:scaleY(0.95) translateY(8px) translateX(8px); margin-right:-36px}
      .hero-title .cg-text{font-size:80px}
      .products-grid{grid-template-columns:1fr}
      .shop-grid{grid-template-columns:1fr}
      .cat-img{height:220px}
      .reviews-btn{display:none}
      .footer-logo-text{font-size:18px}
      .custom{height:360px;padding:20px}
      .custom-content{padding:20px}
      .custom-content h2{font-size:28px;margin-bottom:10px}
      .custom-content p{font-size:14px;margin-bottom:20px}
      .btn-custom{padding:12px 25px;font-size:11px}
      .categories-images-wrapper{padding:0} /* no side gutters */
      .slide{width:100%} /* full width on mobile */
      /* Shop carousels mobile responsive */
      .shop-carousel-wrapper{margin:0 -5px}
      .shop-slide{width:calc(100% - 10px)}
      .shop-carousel-btn{width:35px;height:35px;font-size:16px}
      .shop-carousel-btn.prev{left: 5px}
      .shop-carousel-btn.next{right: 5px}
      /* Search modal mobile responsive */
      .search-content{padding:25px;width:95%}
      .search-title{font-size:24px;margin-bottom:15px}
      .search-categories{gap:8px;margin-bottom:15px}
      .search-category{font-size:11px;padding:6px 12px}
      .search-input{padding:12px 45px 12px 15px;font-size:14px}
      .search-btn{padding:8px 12px;font-size:11px}
      .search-results{max-height:300px}
      .search-result-item{padding:12px}
      .search-result-title{font-size:14px}
      .search-result-desc{font-size:12px}
    }
  </style>
</head>
<body>

  <header>
    <nav>
      <div class="logo cg-display" aria-label="SUKBIT brand" onclick="window.location.href='index.html'" style="cursor:pointer">
        <img src="0792775b-b60a-4221-aeab-c489c138b104-removebg-preview.png" alt="S mark">
        <span>UKBIT</span>
      </div>

      <ul class="nav-links">
        <li class="dropdown">
          <span class="dropdown-toggle">SHOP NOW</span>
          <div class="dropdown-menu">
            <a href="products.html">All Bags</a>
            <a href="products.html?category=handbag">Handbags</a>
            <a href="products.html?category=tote">Tote Bags</a>
            <a href="products.html?category=crossbody">Crossbody Bags</a>
            <a href="products.html?category=clutch">Clutches</a>
            <a href="products.html?category=shoulder">Shoulder Bags</a>
            <a href="products.html?category=beads">Beads Collection</a>
          </div>
        </li>
        <li class="dropdown">
          <span class="dropdown-toggle">MY SUKBIT</span>
          <div class="dropdown-menu">
            <a href="account.html">My Account</a>
            <a href="account.html">Order History</a>
            <a href="account.html">Wishlist</a>
            <a href="custom.html">Custom Orders</a>
            <a href="track.html">Track Order</a>
            <a href="returns.html">Returns</a>
          </div>
        </li>
        <li class="dropdown">
          <span class="dropdown-toggle">MORE INFO</span>
          <div class="dropdown-menu">
            <a href="about.html">About Us</a>
            <a href="story.html">Our Story</a>
            <a href="craftsmanship.html">Craftsmanship</a>
            <a href="materials.html">Materials</a>
            <a href="care.html">Care Guide</a>
            <a href="faq.html">FAQ</a>
            <a href="contact.html">Contact Us</a>
            <a href="shipping.html">Shipping Info</a>
            <a href="size.html">Size Guide</a>
          </div>
        </li>
      </ul>

      <div class="nav-icons">
        <span class="nav-icon" onclick="openSearch()">SEARCH</span>
        <span class="nav-icon" onclick="openAccount()">ACCOUNT</span>
        <span class="nav-icon" onclick="openCart()">CART</span>
      </div>
    </nav>
  </header>

  <section class="hero" aria-label="Hero">
    <div class="hero-content">
      <div class="hero-title-wrap">
        <div class="hero-title cg-display">
          <span class="s-mark"></span>
          <span class="cg-text">UKBIT</span>
        </div>
        <div class="hero-tagline cg-display">
          Lightweight, Functional and Versatile
        </div>
      </div>
    </div>
  </section>

  <section class="font-info">
  </section>

  <section id="products" class="products">
    <h2 class="cg-display">Exclusive Preorder Collection</h2>
    <div class="products-grid">
      <div class="product"><div class="product-img" style="background-image:url('Ivanna-Limited-Gold_Black_Cream_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">IVANNA</h3><p>Limited-tone weave with a polished, structured finish</p><div class="price">₱6,200</div><button class="preorder-btn" onclick="showPopup('IVANNA', '₱6,200')">PREORDER NOW</button></div>
      <div class="product"><div class="product-img" style="background-image:url('FIESTA_gold_0dc52484-0ca1-4b84-9dff-f589a521126b_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">FIESTA</h3><p>Celebration-ready statement bag with a luminous gold weave</p><div class="price">₱5,400</div><button class="preorder-btn" onclick="showPopup('FIESTA', '₱5,400')">PREORDER NOW</button></div>
      <div class="product"><div class="product-img" style="background-image:url('VALENTIA_2TONED_-_Gold_with_White_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">VALENTIA</h3><p>Two-toned elegance designed for day-to-night styling</p><div class="price">₱5,900</div><button class="preorder-btn" onclick="showPopup('VALENTIA', '₱5,900')">PREORDER NOW</button></div>
      <div class="product"><div class="product-img" style="background-image:url('Vittoria-ChocoBrown_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">VITTORIA</h3><p>Rich choco-brown texture with a classic premium silhouette</p><div class="price">₱5,200</div><button class="preorder-btn" onclick="showPopup('VITTORIA', '₱5,200')">PREORDER NOW</button></div>
    </div>
  </section>

  <section class="shop-hand">
    <h2 class="cg-display">Shop Now on Hand</h2>
    <div class="shop-carousel-wrapper">
      <div class="shop-carousel-track" id="shopHandTrack">
        <div class="shop-slide"><div class="shop-item"><div class="shop-img" style="background-image:url('Aina_-_natural_w__black_vertical_lines_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">AINA</h3><p>On-hand • Natural</p><div class="price">₱2,700</div><button class="shop-btn" onclick="showPurchasePopup('AINA', '₱2,700')">PURCHASE</button></div></div>
        <div class="shop-slide"><div class="shop-item"><div class="shop-img" style="background-image:url('BIANCA_Black_with_Choco_Brown_360x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">BIANCA</h3><p>On-hand • Chocolate Brown</p><div class="price">₱3,900</div><button class="shop-btn" onclick="showPurchasePopup('BIANCA', '₱3,900')">PURCHASE</button></div></div>
        <div class="shop-slide"><div class="shop-item"><div class="shop-img" style="background-image:url('LUNA-BLACK_360x.jpg');background-size:cover;background-position:center"></div><h3 class="cg-display">LUNA</h3><p>On-hand • Black</p><div class="price">₱2,800</div><button class="shop-btn" onclick="showPurchasePopup('LUNA', '₱2,800')">PURCHASE</button></div></div>
        <div class="shop-slide"><div class="shop-item"><div class="shop-img" style="background-image:url('PICCOLA_-_GOLD_ef2ed91d-e249-456e-931c-c1bc5502b53b_600x.webp');background-size:cover;background-position:center"></div><h3 class="cg-display">PICCOLA</h3><p>On-hand • Gold</p><div class="price">₱4,500</div><button class="shop-btn" onclick="showPurchasePopup('PICCOLA', '₱4,500')">PURCHASE</button></div></div>
      </div>
    </div>
    <div style="margin-top:26px;text-align:center">
      <a href="products.html" class="shop-btn" style="display:inline-block;text-decoration:none">View All Bags</a>
    </div>
  </section>

  <section class="shop-special">
    <h2 class="cg-display">Shop Now Special Offers</h2>
    <div class="shop-carousel-wrapper">
      <div class="shop-carousel-track" id="shopSpecialTrack">
      </div>
    </div>
  </section>

  <section class="shop-limited">
    <h2 class="cg-display">Shop Now Limited Series</h2>
    <div class="shop-carousel-wrapper">
      <div class="shop-carousel-track" id="shopLimitedTrack">
      </div>
    </div>
  </section>

  <section class="features">
    <h2 class="cg-display">Features of the Product</h2>
    <div class="features-grid">
      <div class="feature-item"><h3 class="cg-display">LIGHTWEIGHT</h3></div>
      <div class="feature-item"><h3 class="cg-display">FUNCTIONAL</h3></div>
      <div class="feature-item"><h3 class="cg-display">VERSATILE</h3></div>
    </div>
  </section>

  <section class="categories">
    <div class="categories-container">
      <div class="categories-sidebar"><h2 class="categories-title cg-display">CATEGORIES</h2></div>

      <div class="categories-right">
        <div class="categories-top-bar"></div>

        <div class="categories-main">
          <div class="categories-images-wrapper" id="categoriesWrapper" aria-label="Categories carousel">
            <button class="carousel-btn prev" data-role="prev" aria-label="Previous">&lsaquo;</button>

            <div class="categories-images" id="categoriesImages" role="list">
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('handbag')"><img src="HANDBAGSCATEGORIES.webp" alt="Handbags"></div></div>
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('tote')"><img src="TOTEBAGSCATEGORIES.webp" alt="Tote Bags"></div></div>
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('crossbody')"><img src="SLINGBAGSCATEGORIES.webp" alt="Crossbody Bags"></div></div>
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('clutch')"><img src="CLUTCHESCATEGORIES.webp" alt="Clutches"></div></div>
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('shoulder')"><img src="SHOULDERBAGSCATEGORIES.webp" alt="Shoulder Bags"></div></div>
              <div class="slide" role="listitem"><div class="cat-img" onclick="searchByCategory('beads')"><img src="BEADS CATEGORIES.webp" alt="Beads Collection"></div></div>
            </div>

            <button class="carousel-btn next" data-role="next" aria-label="Next">&rsaquo;</button>
          </div>
        </div>

        <div class="categories-bottom-bar"></div>
      </div>
    </div>
  </section>

  <section id="custom" class="custom">
    <div class="custom-content">
      <h2 class="cg-display">Design Your Dream Bag</h2>
      <p>Transform your vision into reality with our bespoke customization service. Choose from premium materials, exclusive colors, and personalized details to create a SUKBIT bag that's uniquely yours.</p>
      <button class="btn-custom" onclick="window.location.href='custom.html'">Start Customizing</button>
    </div>
  </section>

  <section class="reviews">
    <h2 class="cg-display">Customer Reviews</h2>

    <div class="reviews-carousel" id="reviewsCarousel">
      <button class="reviews-btn prev" data-role="prev" aria-label="Previous review">&lsaquo;</button>

      <div class="reviews-track">
        <div class="reviews-list" id="reviewsList">
          <div class="review-slide">
            <div class="review-card">
              <div class="review-avatar" style="background-image:url('https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=80&h=80&fit=crop');background-size:cover;background-position:center;border-radius:50%"></div>
              <div class="review-rating">★★★★★</div>
              <div class="review-name">Melanie Aquino</div>
              <div class="review-line"></div>
              <div class="review-text"><strong>I love that it is so lightweight, durable and so stylish.</strong><br>SUKBIT has all kinds of bags in all sizes from casual to formal bags. I love that it is so lightweight, durable and so stylish. If there was a bag which will be appreciated by our balikbayans....this would be it! Plus it is a bag that helps....gives HOPE to its makers ;) Thank you for SUKBIT bags!</div>
              <div class="review-date">Verified Purchase</div>
              <div class="review-verified">Verified Buyer</div>
            </div>
          </div>

          <div class="review-slide">
            <div class="review-card">
              <div class="review-avatar" style="background-image:url('https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=80&h=80&fit=crop');background-size:cover;background-position:center;border-radius:50%"></div>
              <div class="review-rating">★★★★★</div>
              <div class="review-name">Anj Andal</div>
              <div class="review-line"></div>
              <div class="review-text"><strong>Bag designs are beautiful!</strong><br>Bags are of high quality. Very easy to order too. The back story of SUKBIT helping communities makes you feel good about your purchase. :)</div>
              <div class="review-date">Verified Purchase</div>
              <div class="review-verified">Verified Buyer</div>
            </div>
          </div>

          <div class="review-slide">
            <div class="review-card">
              <div class="review-avatar" style="background-image:url('https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?w=80&h=80&fit=crop');background-size:cover;background-position:center;border-radius:50%"></div>
              <div class="review-rating">★★★★★</div>
              <div class="review-name">Bonzai Yulo</div>
              <div class="review-line"></div>
              <div class="review-text"><strong>Traveling with my Rafaela</strong><br>I love the unique styles of SUKBIT bags. I own a few pieces. It’s my day-to-day purse and I use it for travel too. It’s very sturdy. I also love the fact that I am supporting locally made products. 💕</div>
              <div class="review-date">Verified Purchase</div>
              <div class="review-verified">Verified Buyer</div>
            </div>
          </div>

          <div class="review-slide">
            <div class="review-card">
              <div class="review-avatar" style="background-image:url('https://images.unsplash.com/photo-1524503033411-f6e7a9f4f2d6?w=80&h=80&fit=crop');background-size:cover;background-position:center;border-radius:50%"></div>
              <div class="review-rating">★★★★★</div>
              <div class="review-name">Faith Ginete</div>
              <div class="review-line"></div>
              <div class="review-text"><strong>Each bag speaks of my personal style and individuality</strong><br>I love SUKBIT! I got a few of their styles and each speaks of my personal style and individuality. I think they have all the styles that cater to everyone of all ages. SUKBIT has this certain kind of character that speaks elegance and style without compromising functionality. Plus, I love its sustainability and the story behind each bag.</div>
              <div class="review-date">Verified Purchase</div>
              <div class="review-verified">Verified Buyer</div>
            </div>
          </div>
        </div>
      </div>

      <button class="reviews-btn next" data-role="next" aria-label="Next review">&rsaquo;</button>
    </div>

    <div class="reviews-dots" id="reviewsDots"></div>
    
    <div class="leave-review-section">
      <button class="leave-review-btn" onclick="openReviewModal()">Leave a Review</button>
    </div>
  </section>

  <section class="instagram">
    <h2 class="cg-display">Follow us on Instagram</h2>
    <p>@sukbitph</p>
    <div class="ig-grid">
      <div class="ig" style="background-image:url('INSTA1.jpg');background-size:cover;background-position:center"></div>
      <div class="ig" style="background-image:url('INSTA2.jpg');background-size:cover;background-position:center"></div>
      <div class="ig" style="background-image:url('INSTA3.jpg');background-size:cover;background-position:center"></div>
      <div class="ig" style="background-image:url('INSTA4.jpg');background-size:cover;background-position:center"></div>
    </div>
  </section>

  <footer>
    <div class="footer-logo">
      <div class="footer-logo-text cg-display">
        <img src="0792775b-b60a-4221-aeab-c489c138b104-removebg-preview.png" alt="S mark">
        <span>UKBIT</span>
      </div>
    </div>

    <div class="footer-grid">
      <div>
        <h4>Quick Links</h4>
        <ul>
          <li><a href="javascript:void(0)" onclick="openSearch()">Search our Website</a></li>
          <li><a href="about.html">About Us</a></li>
          <li><a href="faq.html">FAQ</a></li>
          <li><a href="terms.html">Terms of Service</a></li>
        </ul>
      </div>

      <div>
        <h4>Contact Us</h4>
        <p>For inquiries and bulk orders,</p>
        <p>email us at</p>
        <p>shop@sukbitph.com</p>
        <p style="margin-top:12px">Phone Number:</p>
        <p>(63) 09123-4567</p>
      </div>

      <div>
        <h4>Payment Options</h4>
        <ul>
          <li>Gcash</li>
          <li>BDO</li>
          <li>BPI</li>
          <li>VISA CARD</li>
          <li>MASTERCARD</li>
          <li>PAYPAL</li>
        </ul>
      </div>

      <div>
        <h4>Visit Us</h4>
        <p>Philippines at ...</p>
        <h4 style="margin-top:20px">Subscribe to our emails</h4>
        <form class="newsletter-form" onsubmit="handleNewsletterSubmit(event)">
          <input type="email" placeholder="Email" required>
          <button type="submit">→</button>
        </form>
      </div>
    </div>
  </footer>

  <!-- Back to Top Button -->
  <button class="back-to-top" onclick="scrollToTop()" aria-label="Back to top">↑</button>

  <!-- ACCOUNT MODAL -->
  <div class="account-modal" id="accountModal">
    <div class="account-content">
      <button class="account-close" onclick="closeAccount()">×</button>
      <h2 class="account-title">My Account</h2>
      
      <div class="account-tabs">
        <button class="account-tab active" onclick="switchAccountTab('login', event)">Login</button>
        <button class="account-tab" onclick="switchAccountTab('register', event)">Register</button>
      </div>
      
      <form class="account-form active" id="loginForm" onsubmit="handleLogin(event)">
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <input type="email" class="form-input" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" placeholder="Enter your password" required>
        </div>
        <div class="form-checkbox">
          <input type="checkbox" id="remember">
          <label for="remember">Remember me</label>
        </div>
        <button type="submit" class="form-submit">Login</button>
      </form>
      
      <form class="account-form" id="registerForm" onsubmit="handleRegister(event)">
        <div class="form-group">
          <label class="form-label">Full Name</label>
          <input type="text" class="form-input" placeholder="Enter your full name" required>
        </div>
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <input type="email" class="form-input" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" placeholder="Create a password" required>
        </div>
        <div class="form-group">
          <label class="form-label">Confirm Password</label>
          <input type="password" class="form-input" placeholder="Confirm your password" required>
        </div>
        <div class="form-checkbox">
          <input type="checkbox" id="terms" required>
          <label for="terms">I agree to the Terms & Conditions</label>
        </div>
        <button type="submit" class="form-submit">Create Account</button>
      </form>
      
      <div class="account-links">
        <a href="javascript:void(0)" onclick="showAccountLinks()">Forgot Password?</a>
        <a href="javascript:void(0)" onclick="showAccountLinks()">Need Help?</a>
      </div>
    </div>
  </div>

  <!-- CART MODAL -->
  <div class="cart-modal" id="cartModal">
    <div class="cart-content">
      <button class="cart-close" onclick="closeCart()">×</button>
      <h2 class="cart-title">Shopping Cart</h2>
      
      <div id="cartItems">
        <div class="cart-empty">
          <p>Your cart is empty</p>
          <p>Add some beautiful SUKBIT bags to get started!</p>
        </div>
      </div>
      
      <div class="cart-summary" id="cartSummary" style="display:none;">
        <div class="cart-total">
          <span>Total:</span>
          <span id="cartTotal">₱0</span>
        </div>
        <button class="cart-checkout" onclick="proceedToCheckout()">Proceed to Checkout</button>
        <a href="javascript:void(0)" class="cart-continue" onclick="closeCart()">Continue Shopping</a>
      </div>
    </div>
  </div>

  <!-- REVIEW MODAL -->
  <div class="review-modal" id="reviewModal">
    <div class="review-content">
      <button class="review-close" onclick="closeReviewModal()">×</button>
      <h2 class="review-title">Share Your Experience</h2>
      
      <form class="review-form" onsubmit="submitReview(event)">
        <div class="review-form-group">
          <label class="review-form-label">Your Name</label>
          <input type="text" class="review-form-input" placeholder="Enter your name" required>
        </div>
        
        <div class="review-form-group">
          <label class="review-form-label">Email Address</label>
          <input type="email" class="review-form-input" placeholder="Enter your email" required>
        </div>
        
        <div class="review-form-group">
          <label class="review-form-label">Rating</label>
          <div class="review-rating-input">
            <span class="review-star" onclick="setRating(1)">★</span>
            <span class="review-star" onclick="setRating(2)">★</span>
            <span class="review-star" onclick="setRating(3)">★</span>
            <span class="review-star" onclick="setRating(4)">★</span>
            <span class="review-star" onclick="setRating(5)">★</span>
          </div>
        </div>
        
        <div class="review-form-group">
          <label class="review-form-label">Your Review</label>
          <textarea class="review-form-textarea" placeholder="Tell us about your experience with SUKBIT bags..." required></textarea>
        </div>
        
        <button type="submit" class="review-submit">Submit Review</button>
      </form>
    </div>
  </div>

  <!-- PREORDER SUCCESS POPUP -->
  <div class="popup-overlay" id="preorderSuccessPopup">
    <div class="popup" style="max-width:700px;max-height:85vh;overflow-y:auto;">
      <div class="popup-content" style="padding:0;">
        <!-- Header Section with Success Icon -->
        <div style="background:linear-gradient(135deg,var(--brand-brown) 0%,var(--text-brown) 100%);padding:40px;text-align:center;position:relative;">
          <div style="position:absolute;top:15px;right:15px;">
            <button onclick="closePreorderSuccess()" style="background:rgba(255,255,255,0.2);border:none;color:#fff;width:35px;height:35px;border-radius:50%;cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;transition:all 0.3s ease;" onmouseover="this.style.background='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.2)'">×</button>
          </div>
          <div style="width:90px;height:90px;background:rgba(255,255,255,0.15);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;border:3px solid rgba(255,255,255,0.3);backdrop-filter:blur(10px);">
            <span style="font-size:45px;color:#fff;">✓</span>
          </div>
          <h2 class="popup-product-name" style="font-size:32px;margin-bottom:10px;color:#fff;">Preorder Confirmed!</h2>
          <p style="color:rgba(255,255,255,0.9);font-size:16px;">Thank you for choosing SUKBIT</p>
        </div>
        
        <!-- Order Details Section -->
        <div style="padding:40px;background:#fff;">
          <div style="background:var(--brand-cream);padding:30px;border-radius:20px;margin-bottom:30px;position:relative;overflow:hidden;">
            <div style="position:absolute;top:0;left:0;width:100%;height:4px;background:linear-gradient(90deg,var(--brand-brown),var(--text-brown));"></div>
            <h3 style="font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--text-brown);margin-bottom:25px;text-align:center;">Order Summary</h3>
            <div id="preorderSummary"></div>
          </div>
          
          <!-- Timeline Section -->
          <div style="background:#f9f6f2;padding:25px;border-radius:15px;margin-bottom:30px;">
            <h4 style="font-family:'Cormorant Garamond',serif;font-size:18px;color:var(--text-brown);margin-bottom:15px;">What's Next?</h4>
            <div style="display:flex;align-items:center;gap:15px;margin-bottom:15px;">
              <div style="width:30px;height:30px;background:var(--brand-brown);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:bold;">1</div>
              <div style="flex:1;">
                <div style="font-weight:600;color:var(--text-brown);margin-bottom:2px;">Confirmation Email</div>
                <div style="font-size:13px;color:var(--text-brown);opacity:0.7;">You'll receive an order confirmation within 5 minutes</div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:15px;margin-bottom:15px;">
              <div style="width:30px;height:30px;background:var(--brand-brown);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:bold;">2</div>
              <div style="flex:1;">
                <div style="font-weight:600;color:var(--text-brown);margin-bottom:2px;">Handcrafting Process</div>
                <div style="font-size:13px;color:var(--text-brown);opacity:0.7;">Your bag will be carefully crafted by our artisans</div>
              </div>
            </div>
            <div style="display:flex;align-items:center;gap:15px;">
              <div style="width:30px;height:30px;background:var(--brand-brown);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:bold;">3</div>
              <div style="flex:1;">
                <div style="font-weight:600;color:var(--text-brown);margin-bottom:2px;">Delivery</div>
                <div style="font-size:13px;color:var(--text-brown);opacity:0.7;">Expected delivery: 2-3 weeks</div>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;">
            <button class="popup-action-btn" onclick="closePreorderSuccess()" style="padding:12px 30px;font-size:14px;min-width:150px;">Continue Shopping</button>
            <button class="popup-preorder-btn" onclick="window.location.href='account.html'" style="padding:12px 30px;font-size:14px;min-width:150px;">View My Orders</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SEARCH MODAL -->
  <div class="search-modal" id="searchModal">
    <div class="search-content">
      <button class="search-close" onclick="closeSearch()">×</button>
      <h2 class="search-title">Search SUKBIT</h2>
      
      <div class="search-categories">
        <span class="search-category" onclick="searchByCategory('bags')">Bags</span>
        <span class="search-category" onclick="searchByCategory('handbags')">Handbags</span>
        <span class="search-category" onclick="searchByCategory('tote')">Tote Bags</span>
        <span class="search-category" onclick="searchByCategory('crossbody')">Crossbody</span>
        <span class="search-category" onclick="searchByCategory('clutch')">Clutches</span>
        <span class="search-category" onclick="searchByCategory('custom')">Custom</span>
      </div>
      
      <div class="search-input-wrapper">
        <input type="text" class="search-input" id="searchInput" placeholder="Search for bags, colors, materials..." onkeyup="performSearch(event)">
        <button class="search-btn" onclick="performSearch()">Search</button>
      </div>
      
      <div class="search-results" id="searchResults"></div>
    </div>
  </div>

  <!-- COMPLETE PREORDER POPUP - MATCHING NEW IMAGE DESIGN -->
  <div class="popup-overlay" id="preorderPopup">
    <div class="popup">
      <button class="popup-close" onclick="closePopup()">×</button>
      <div class="popup-content">
        <div class="popup-image-section">
          <div class="popup-image"></div>
        </div>
        <div class="popup-details">
          <h2 class="popup-product-name">SUKBIT BAG IN BEIGE</h2>
          <div class="popup-price">₱1,899</div>
          <div class="popup-description">Handwoven Filipino Bags</div>
          
          <div class="popup-divider"></div>
          
          <div class="popup-section">
            <div class="popup-section-title">Colors</div>
            <div class="color-selection">
              <div class="color-btn" onclick="toggleColorPalette(this, 'color1')">
                COLOR 1
                <div class="color-swatch" id="color1-swatch"></div>
                <div class="color-palette" id="color1-palette">
                  <div class="color-option" style="background:#f6f1ea" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#ffffff" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#e8ddd0" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#d9c7b5" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#b5a393" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#a89278" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#9b846a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#7a634e" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#5a4a3a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#4a3a2a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#2b2b2b" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#c0c0c0" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#d4af37" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#f2c94c" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#f2994a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#e67e22" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#d44c4c" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#b43838" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#f08a8a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#d96fa1" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#6fcf97" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#27ae60" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#1b7f5a" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#a3d9a5" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#56ccf2" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#2d9cdb" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#2f80ed" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#1b4f72" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#9bb7d4" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#9b51e0" onclick="selectColor(this, 'color1')"></div>
                  <div class="color-option" style="background:#6c5ce7" onclick="selectColor(this, 'color1')"></div>
                  <input class="color-input" type="color" value="#f6f1ea" onchange="selectCustomColor(this, 'color1')" />
                </div>
              </div>
              <div class="color-btn" onclick="toggleColorPalette(this, 'color2')">
                COLOR 2
                <div class="color-swatch" id="color2-swatch"></div>
                <div class="color-palette" id="color2-palette">
                  <div class="color-option" style="background:#f6f1ea" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#ffffff" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#e8ddd0" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#d9c7b5" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#b5a393" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#a89278" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#9b846a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#7a634e" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#5a4a3a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#4a3a2a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#2b2b2b" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#c0c0c0" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#d4af37" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#f2c94c" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#f2994a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#e67e22" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#d44c4c" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#b43838" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#f08a8a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#d96fa1" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#6fcf97" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#27ae60" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#1b7f5a" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#a3d9a5" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#56ccf2" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#2d9cdb" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#2f80ed" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#1b4f72" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#9bb7d4" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#9b51e0" onclick="selectColor(this, 'color2')"></div>
                  <div class="color-option" style="background:#6c5ce7" onclick="selectColor(this, 'color2')"></div>
                  <input class="color-input" type="color" value="#f6f1ea" onchange="selectCustomColor(this, 'color2')" />
                </div>
              </div>
            </div>
          </div>
          
          <div class="popup-section">
            <div class="popup-section-title">Size</div>
            <div class="size-selection">
              <button class="size-btn active" onclick="selectSize(this)">ONE SIZE</button>
            </div>
          </div>
          
          <div class="popup-section">
            <div class="popup-section-title">Quantity</div>
            <div class="quantity-selector">
              <button class="quantity-btn" onclick="changeQuantity(-1)">−</button>
              <div class="quantity-display" id="quantity">1</div>
              <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
            </div>
          </div>
          
          <button class="popup-preorder-btn" onclick="handlePreorder()">PREORDER</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let quantity = 1;
    let selectedColors = { color1: null, color2: null };
    let currentProduct = null;
    let purchaseQuantity = 1;
    let currentPurchaseProduct = null;
    let selectedRating = 0;

    // Cart Functions - Using localStorage for persistence
    function getCartItems() {
      const stored = localStorage.getItem('sukbitCart');
      return stored ? JSON.parse(stored) : [];
    }

    function saveCartItems(items) {
      localStorage.setItem('sukbitCart', JSON.stringify(items));
    }

    function addToCart(product, price, quantity = 1, image = null) {
      const cartItems = getCartItems();
      const existingItem = cartItems.find(item => item.name === product);

      if (!image && typeof PRODUCT_IMAGE_MAP !== 'undefined' && PRODUCT_IMAGE_MAP[product]) {
        image = PRODUCT_IMAGE_MAP[product];
      }
      
      if (existingItem) {
        existingItem.quantity += quantity;
        if (!existingItem.image && image) {
          existingItem.image = image;
        }
      } else {
        cartItems.push({
          name: product,
          price: price,
          quantity: quantity,
          image: image,
          id: Date.now() // Unique ID for each item
        });
      }
      
      saveCartItems(cartItems);
      updateCartDisplay();
      
      // Get the last added item for notification
      const lastItem = cartItems[cartItems.length - 1];
      const priceStr = typeof lastItem.price === 'string' ? lastItem.price : '₱' + lastItem.price.toLocaleString();
      showCartNotification(lastItem.name, priceStr, quantity, lastItem.image);
    }

    function removeFromCart(index) {
      const cartItems = getCartItems();
      cartItems.splice(index, 1);
      saveCartItems(cartItems);
      updateCartDisplay();
    }

    function updateQuantity(index, change) {
      const cartItems = getCartItems();
      const item = cartItems[index];
      item.quantity += change;
      
      if (item.quantity <= 0) {
        cartItems.splice(index, 1);
      }
      
      saveCartItems(cartItems);
      updateCartDisplay();
    }

    function updateCartDisplay() {
      const cartItems = getCartItems();
      const cartItemsContainer = document.getElementById('cartItems');
      const cartSummary = document.getElementById('cartSummary');
      
      if (cartItems.length === 0) {
        cartItemsContainer.innerHTML = `
          <div class="cart-empty">
            <p>Your cart is empty</p>
            <p>Add some beautiful SUKBIT bags to get started!</p>
          </div>
        `;
        cartSummary.style.display = 'none';
      } else {
        cartItemsContainer.innerHTML = cartItems.map((item, index) => {
          // Format price correctly
          const priceStr = typeof item.price === 'string' ? item.price : '₱' + item.price.toLocaleString();
          const priceNum = typeof item.price === 'string' ? parseInt(item.price.replace('₱', '').replace(/,/g, '')) : item.price;
          const itemTotal = priceNum * item.quantity;
          const imageStyle = item.image ? `background-image:url('${item.image}');background-size:cover;background-position:center;` : '';
          
          return `
            <div class="cart-item">
              <div class="cart-item-image" style="${imageStyle}"></div>
              <div class="cart-item-info">
                <div class="cart-item-name">${item.name}</div>
                <div class="cart-item-price">${priceStr}</div>
              </div>
              <div class="cart-item-quantity">
                <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">−</button>
                <span class="quantity-value">${item.quantity}</span>
                <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
              </div>
              <div class="cart-item-total">₱${itemTotal.toLocaleString()}</div>
              <button class="cart-item-remove" onclick="removeFromCart(${index})">×</button>
            </div>
          `;
        }).join('');
        
        const cartTotal = cartItems.reduce((total, item) => {
          const priceNum = typeof item.price === 'string' ? parseInt(item.price.replace('₱', '').replace(/,/g, '')) : item.price;
          return total + (priceNum * item.quantity);
        }, 0);
        
        document.getElementById('cartTotal').textContent = '₱' + cartTotal.toLocaleString();
        cartSummary.style.display = 'block';
      }
    }

    function showCartNotification(product, price, quantity, image) {
      const cartItems = getCartItems();
      const cartTotal = cartItems.reduce((total, item) => {
        const priceNum = typeof item.price === 'string' ? parseInt(item.price.replace('₱', '').replace(/,/g, '')) : item.price;
        return total + (priceNum * item.quantity);
      }, 0);

      let img = image;
      if (!img && typeof window.PRODUCT_IMAGE_MAP !== 'undefined') {
        img = PRODUCT_IMAGE_MAP[product] || '';
      }
      
      // Create notification element
      const notification = document.createElement('div');
      notification.className = 'cart-notification';
      const thumb = img ? `<div style="width:44px;height:44px;border-radius:10px;background-image:url('${img}');background-size:cover;background-position:center;flex:0 0 44px;box-shadow:0 6px 16px rgba(0,0,0,0.18);"></div>` : '';
      notification.innerHTML = `
        <div class="notification-content" style="gap:12px;">
          ${thumb}
          <div style="display:flex;flex-direction:column;gap:2px;flex:1;min-width:0;">
            <span class="notification-item" style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${product}</span>
            <span style="font-size:12px;opacity:0.9;">${price} • ×${quantity}</span>
          </div>
        </div>
        <div class="notification-total">Cart Total: ₱${cartTotal.toLocaleString()}</div>
      `;
      
      // Add to page
      document.body.appendChild(notification);
      
      // Remove after 3 seconds
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 3000);
    }

    // Helper functions for description processing - must be defined before use
    function cleanText(text) {
      return (text || '')
        .replace(/:contentReference\[[^\]]+\]\{[^\}]+\}/g, '')
        .replace(/speranza/ig, 'SUKBIT')
        .trim();
    }

    function cleanBrandText(text) {
      return (text || '')
        .replace(/:contentReference\[[^\]]+\]\{[^\}]+\}/g, '')
        .replace(/speranza/ig, 'SUKBIT')
        .trim();
    }

    function truncateText(text, maxLen) {
      const s = String(text || '').trim();
      const n = Math.max(0, parseInt(maxLen, 10) || 0);
      if (!n || s.length <= n) return s;
      const cut = s.slice(0, n).replace(/\s+\S*$/, '').trim();
      return (cut || s.slice(0, n)).trim() + '…';
    }

    const CARD_DESC_MAX = 120;

    function normalizeSentences(text, maxSentences) {
      const s = String(text || '').replace(/\s+/g, ' ').trim();
      if (!s) return '';
      const parts = s.split(/(?<=[.!?])\s+/).map(x => x.trim()).filter(Boolean);
      const seen = new Set();
      const out = [];
      for (const p of parts) {
        const k = p.toLowerCase().replace(/[^a-z0-9]+/g, ' ').trim();
        if (!k || seen.has(k)) continue;
        seen.add(k);
        out.push(p);
        if (maxSentences && out.length >= maxSentences) break;
      }
      return out.join(' ');
    }

    function normalizeBagDescription(raw, key, maxSentences) {
      const k = String(key || '').trim().toUpperCase();
      let s = cleanBrandText(cleanText(String(raw || '')));
      if (k) {
        const re = new RegExp('^\\s*' + k + '\\b\\s*[:\u2013\u2014\-]?\\s*', 'i');
        s = s.replace(re, '');
      }
      s = normalizeSentences(s, maxSentences);
      return s;
    }

    function formatCardDescription(raw, key) {
      const base = normalizeBagDescription(raw, key, 2);
      return truncateText(base, CARD_DESC_MAX);
    }

    function keyFromDisplayNameGlobal(name) {
      const cleaned = String(name || '').trim().replace(/\s+(II|III|IV|V|\d+)$/i, '');
      const parts = cleaned.split(/\s+/).filter(Boolean);
      if (parts.length === 0) return '';
      if (parts[0].toUpperCase() === 'MINI' && parts.length > 1) return parts[1].toUpperCase();
      if (parts[0].toUpperCase() === 'MAXI' && parts.length > 1) return parts[1].toUpperCase();
      
      // Handle special cases like "Mini Rafaela" -> "RAFAELA"
      if (parts.length >= 2 && (parts[0].toUpperCase() === 'MINI' || parts[0].toUpperCase() === 'MAXI')) {
        return parts[1].toUpperCase();
      }
      
      return parts[0].toUpperCase();
    }

    function generateFallbackDescription(productName) {
      const name = String(productName || '').trim();
      const bagType = inferBagTypeFromName(name);

      const key = keyFromDisplayNameGlobal(name);
      if (key === 'ALORA' || key === 'ALORAWASHEDBLUE') {
        return 'A handcrafted standout in blue tones—easy to style, easy to carry, and made for everyday versatility.';
      }
      if (key === 'AMPARO') {
        return 'AMPARO brings a bright pop of color with a clean, polished look—made for easy everyday styling.';
      }
      if (key === 'AVA') {
        return 'AVA is a sleek, modern essential designed to keep your day-to-night basics close in a refined silhouette.';
      }
      if (key === 'BEATRIZ') {
        return 'BEATRIZ is timeless and elevated—an effortless statement piece that pairs beautifully with any outfit.';
      }
      
      const descriptions = {
        'CLUTCH': 'Elegant clutch perfect for evening occasions and special events. Compact yet spacious enough for your essentials.',
        'TOTE': 'Spacious tote bag perfect for daily use and shopping trips. Combines functionality with elegant SUKBIT craftsmanship.',
        'SHOULDER': 'Versatile shoulder bag designed for everyday elegance. Comfortable to carry with ample space for your daily essentials.',
        'CROSSBODY': 'Hands-free crossbody bag for modern convenience. Perfect for busy days when you need your essentials within reach.',
        'HANDMADE': 'Handcrafted with attention to detail by skilled artisans. Each piece reflects traditional SUKBIT weaving techniques.',
        'BEADS': 'Intricate beadwork creates stunning visual appeal. Lightweight yet durable for everyday wear.',
        'PREMIUM': 'Premium quality materials and craftsmanship. A statement piece that elevates any outfit.',
        'MINI': 'Compact and adorable mini bag perfect for essentials. Ideal for when you want to travel light without sacrificing style.',
        'PHONE': 'Convenient phone purse with secure storage. Protects your device while adding a touch of elegance to your outfit.',
        'MESSENGER': 'Practical messenger bag with organized compartments. Perfect for work or school with comfortable shoulder strap.',
        'EVENING': 'Sophisticated evening bag for special occasions. Adds glamour and elegance to your formal attire.',
        'CASUAL': 'Versatile casual bag for everyday adventures. Combines comfort with stylish design for your daily routine.',
        'default': 'Beautifully handcrafted bag showcasing SUKBIT\'s commitment to quality and traditional Filipino craftsmanship.'
      };
      
      // Determine description based on bag type or name
      for (const [type, desc] of Object.entries(descriptions)) {
        if (type === 'default') continue;
        if (name.toUpperCase().includes(type) || bagType.toUpperCase().includes(type)) {
          return desc;
        }
      }
      
      return descriptions.default;
    }

    function inferBagTypeFromName(name) {
      const n = String(name || '').toUpperCase();
      if (n.includes('CLUTCH')) return 'clutch';
      if (n.includes('TOTE')) return 'tote';
      if (n.includes('SHOULDER')) return 'shoulder';
      if (n.includes('CROSSBODY')) return 'crossbody';
      if (n.includes('PHONE') || n.includes('PURSE')) return 'phone';
      if (n.includes('MESSENGER')) return 'messenger';
      if (n.includes('MINI')) return 'mini';
      if (n.includes('EVENING')) return 'evening';
      if (n.includes('BEAD')) return 'beads';
      if (n.includes('HANDMADE')) return 'handmade';
      if (n.includes('PREMIUM') || n.includes('GOLD')) return 'premium';
      if (n.includes('CASUAL')) return 'casual';
      return 'handbag';
    }
      function getBagDescriptionFor(productName) {
      const bagByKey = window.BAG_LOOKUP || null;
      if (!bagByKey) {
        console.log('BAG_LOOKUP is null or undefined');
        return 'Handwoven Filipino Bags';
      }
      
      // Try multiple key variations to find the bag
      const keysToTry = [
        keyFromDisplayNameGlobal(productName),
        productName.trim().toUpperCase(),
        productName.split(/\s+/)[0].toUpperCase()
      ];
      
      for (const key of keysToTry) {
        const bag = bagByKey[key];
        if (bag && bag.description) {
          const cleaned = normalizeBagDescription(String(bag.description), key, 3);
          console.log(`getBagDescriptionFor: ${productName} -> key: ${key}, SUCCESS`);
          return cleaned;
        }
      }
      
      // Fallback: try to get description from the card itself
      const cardElements = document.querySelectorAll('.shop-item h3');
      console.log(`Looking for ${productName} in ${cardElements.length} cards`);
      
      for (const cardEl of cardElements) {
        const cardName = cardEl.textContent.trim();
        console.log(`Checking card: "${cardName}" vs "${productName}"`);
        
        if (cardName.toUpperCase() === productName.trim().toUpperCase()) {
          const card = cardEl.closest('.shop-item');
          const descEl = card.querySelector('p');
          console.log(`Found matching card, description element:`, descEl);
          
          if (descEl && descEl.textContent && descEl.textContent !== 'Handwoven Filipino Bags') {
            const desc = descEl.textContent.trim();
            
            // If description is truncated or we want full description, get full description from JSON
            if (desc.endsWith('...') || desc.length < 100) {
              console.log(`Card description is truncated or short (${desc.length} chars), getting full description from JSON`);
              
              // Try to find the bag in JSON by searching all bags
              for (const [jsonKey, jsonBag] of Object.entries(bagByKey)) {
                if (jsonBag.name && jsonBag.name.toUpperCase().includes(productName.trim().toUpperCase())) {
                  const fullDesc = normalizeBagDescription(String(jsonBag.description), jsonKey, 3);
                  console.log(`getBagDescriptionFor: ${productName} -> found full description in JSON: "${fullDesc}"`);
                  return fullDesc;
                }
              }
              
              // If still not found, generate fallback
              const fallback = generateFallbackDescription(productName);
              console.log(`getBagDescriptionFor: ${productName} -> using fallback: "${fallback}"`);
              return fallback;
            }
            
            console.log(`getBagDescriptionFor: ${productName} -> found description in card: "${desc}"`);
            return desc;
          } else {
            console.log(`Card description not found or is fallback: "${descEl ? descEl.textContent : 'null'}"`);
          }
        }
      }
      
      console.log(`getBagDescriptionFor: ${productName} -> NO MATCH, keys tried: ${keysToTry.join(', ')}`);
      return generateFallbackDescription(productName);
    }

    // Purchase Popup Functions - GLOBAL
    function showPurchasePopup(productName, productPrice) {
      const purchasePopup = document.createElement('div');
      purchasePopup.className = 'popup-overlay active';
      purchasePopup.innerHTML = `
        <div class="popup">
          <button class="popup-close" onclick="closePurchasePopup()">×</button>
          <div class="popup-content">
            <div class="popup-image-section">
              <div class="popup-image"></div>
            </div>
            <div class="popup-details">
              <h2 class="popup-product-name">${productName}</h2>
              <div class="popup-price">${productPrice}</div>
              <div class="popup-description"></div>
              
              <div class="popup-divider"></div>
              
              <div class="popup-section">
                <div class="popup-section-title">Quantity</div>
                <div class="quantity-selector">
                  <button class="quantity-btn" onclick="changePurchaseQuantity(-1)">−</button>
                  <div class="quantity-display" id="purchaseQuantity">1</div>
                  <button class="quantity-btn" onclick="changePurchaseQuantity(1)">+</button>
                </div>
              </div>
              
              <button class="popup-preorder-btn" onclick="handlePurchase('${productName}', '${productPrice}')">ADD TO CART</button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(purchasePopup);
      purchaseQuantity = 1;
      const purchaseKey = (typeof keyFromDisplayNameGlobal === 'function')
        ? keyFromDisplayNameGlobal(productName)
        : String(productName || '').trim().split(/\s+/)[0].toUpperCase();
      const purchaseImage = (
        (typeof window.PRODUCT_IMAGE_MAP !== 'undefined' && (PRODUCT_IMAGE_MAP[productName] || PRODUCT_IMAGE_MAP[purchaseKey]))
        || (typeof getImageForBag === 'function' ? getImageForBag(purchaseKey) : '')
        || ''
      );
      currentPurchaseProduct = { name: productName, price: productPrice, image: purchaseImage };

      const purchaseImageEl = purchasePopup.querySelector('.popup-image');
      if (purchaseImageEl) {
        if (purchaseImage) {
          purchaseImageEl.style.backgroundImage = `url('${purchaseImage}')`;
          purchaseImageEl.style.backgroundSize = 'cover';
          purchaseImageEl.style.backgroundPosition = 'center';
          purchaseImageEl.style.backgroundRepeat = 'no-repeat';
        } else {
          purchaseImageEl.style.background = 'linear-gradient(135deg,#c8d8e8 0%,#a8c8d8 100%)';
        }
      }

      const descEl = purchasePopup.querySelector('.popup-description');
      if (descEl) descEl.textContent = getBagDescriptionFor(productName);
    }

    function closePurchasePopup() {
      const popup = document.querySelector('.popup-overlay:not(#preorderPopup)');
      if (popup) {
        popup.remove();
      }
    }

    function changePurchaseQuantity(change) {
      purchaseQuantity = Math.max(1, purchaseQuantity + change);
      const display = document.getElementById('purchaseQuantity');
      if (display) {
        display.textContent = purchaseQuantity;
      }
    }

    function handlePurchase(productName, productPrice) {
      addToCart(currentPurchaseProduct.name, currentPurchaseProduct.price, purchaseQuantity, currentPurchaseProduct.image);
      closePurchasePopup();
    }

    // Preorder Popup Functions - GLOBAL
    function rgbToHexString(rgb) {
      const m = String(rgb || '').match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);
      if (!m) return '';
      const r = Math.max(0, Math.min(255, parseInt(m[1], 10) || 0));
      const g = Math.max(0, Math.min(255, parseInt(m[2], 10) || 0));
      const b = Math.max(0, Math.min(255, parseInt(m[3], 10) || 0));
      const to2 = (n) => n.toString(16).padStart(2, '0');
      return `#${to2(r)}${to2(g)}${to2(b)}`.toUpperCase();
    }

    function closeAllColorPalettes() {
      document.querySelectorAll('.color-palette.active').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.color-btn.active').forEach(b => b.classList.remove('active'));
    }

    function toggleColorPalette(btn, colorKey) {
      if (typeof event !== 'undefined' && event && typeof event.stopPropagation === 'function') event.stopPropagation();
      const palette = document.getElementById(`${colorKey}-palette`);
      if (!palette) return;

      const willOpen = !palette.classList.contains('active');
      closeAllColorPalettes();
      if (willOpen) {
        palette.classList.add('active');
        if (btn) btn.classList.add('active');
      }
    }

    function updateColorSelection(colorKey, hex, selectedEl) {
      const swatch = document.getElementById(`${colorKey}-swatch`);
      if (swatch) swatch.style.background = hex || 'transparent';
      selectedColors[colorKey] = hex || null;

      const palette = document.getElementById(`${colorKey}-palette`);
      if (palette) palette.querySelectorAll('.color-option.selected').forEach(o => o.classList.remove('selected'));
      if (selectedEl && selectedEl.classList) selectedEl.classList.add('selected');

      closeAllColorPalettes();
    }

    function selectColor(el, colorKey) {
      if (typeof event !== 'undefined' && event && typeof event.stopPropagation === 'function') event.stopPropagation();
      const bg = (el && el.style && el.style.background) ? el.style.background : '';
      const hex = bg && bg.startsWith('#') ? bg.toUpperCase() : rgbToHexString(window.getComputedStyle(el).backgroundColor);
      if (!hex) return;
      updateColorSelection(colorKey, hex, el);
    }

    function selectCustomColor(input, colorKey) {
      if (typeof event !== 'undefined' && event && typeof event.stopPropagation === 'function') event.stopPropagation();
      const hex = String(input && input.value ? input.value : '').toUpperCase();
      if (!hex) return;
      updateColorSelection(colorKey, hex, null);
    }

    function showPopup(productName, productPrice) {
      const popup = document.getElementById('preorderPopup');
      const nameElement = popup.querySelector('.popup-product-name');
      const priceElement = popup.querySelector('.popup-price');
      const descElement = popup.querySelector('.popup-description');
      const imageElement = popup.querySelector('.popup-image');
      
      if (nameElement) nameElement.textContent = productName;
      if (priceElement) priceElement.textContent = productPrice;
      if (descElement) descElement.textContent = getBagDescriptionFor(productName);

      const preorderKey = (typeof keyFromDisplayNameGlobal === 'function')
        ? keyFromDisplayNameGlobal(productName)
        : String(productName || '').trim().split(/\s+/)[0].toUpperCase();
      const preorderImage = (
        (typeof window.PRODUCT_IMAGE_MAP !== 'undefined' && (PRODUCT_IMAGE_MAP[productName] || PRODUCT_IMAGE_MAP[preorderKey]))
        || (typeof getImageForBag === 'function' ? getImageForBag(preorderKey) : '')
        || ''
      );
      if (imageElement) {
        if (preorderImage) {
          imageElement.style.backgroundImage = `url('${preorderImage}')`;
          imageElement.style.backgroundSize = 'cover';
          imageElement.style.backgroundPosition = 'center';
          imageElement.style.backgroundRepeat = 'no-repeat';
        } else {
          imageElement.style.background = 'linear-gradient(135deg,#c8d8e8 0%,#a8c8d8 100%)';
        }
      }

      selectedColors = { color1: null, color2: null };
      const sw1 = document.getElementById('color1-swatch');
      const sw2 = document.getElementById('color2-swatch');
      if (sw1) sw1.style.background = 'transparent';
      if (sw2) sw2.style.background = 'transparent';
      closeAllColorPalettes();
      document.querySelectorAll('#preorderPopup .color-option.selected').forEach(o => o.classList.remove('selected'));
      
      currentProduct = { name: productName, price: productPrice, image: preorderImage };
      popup.classList.add('active');
    }

    function closePopup() {
      document.getElementById('preorderPopup').classList.remove('active');
      quantity = 1;
      selectedColors = { color1: null, color2: null };
      document.getElementById('quantity').textContent = '1';
      const sw1 = document.getElementById('color1-swatch');
      const sw2 = document.getElementById('color2-swatch');
      if (sw1) sw1.style.background = 'transparent';
      if (sw2) sw2.style.background = 'transparent';
      closeAllColorPalettes();
      document.querySelectorAll('#preorderPopup .color-option.selected').forEach(o => o.classList.remove('selected'));
    }

    function changeQuantity(change) {
      quantity = Math.max(1, quantity + change);
      document.getElementById('quantity').textContent = quantity;
    }

    function handlePreorder() {
      const basePrice = parseInt(String(currentProduct.price || '').replace('₱', '').replace(/,/g, ''));
      const totalPrice = basePrice * quantity;

      if (totalPrice <= 0 || quantity <= 0) {
        showNotification('Error', 'Invalid price or quantity. Please check your selection.');
        return;
      }

      if (totalPrice > 100000) {
        showNotification('Error', 'Order total exceeds maximum limit. Please reduce quantity.');
        quantity = 1;
        document.getElementById('quantity').textContent = quantity;
        return;
      }

      const preorderData = {
        product: currentProduct.name,
        price: currentProduct.price,
        quantity: quantity,
        color1: selectedColors.color1,
        color2: selectedColors.color2,
        size: 'ONE SIZE',
        total: `₱${totalPrice.toLocaleString()}`
      };

      console.log('Preorder data:', preorderData);
      
      // Show success popup with order summary
      const summaryHTML = `
        <div style="display:grid;grid-template-columns:110px 1fr;gap:15px;align-items:center;">
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">PRODUCT</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.product}</div>
          
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">QUANTITY</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.quantity}</div>
          
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">COLOR 1</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.color1 || 'Not selected'}</div>
          
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">COLOR 2</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.color2 || 'Not selected'}</div>
          
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">SIZE</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.size}</div>
          
          <div style="color:var(--text-brown);opacity:0.7;font-size:14px;font-weight:500;">UNIT PRICE</div>
          <div style="color:var(--text-brown);font-weight:600;font-size:15px;">${preorderData.price}</div>
        </div>
        <div style="margin-top:25px;padding-top:20px;border-top:2px solid rgba(155,132,106,0.2);display:flex;justify-content:space-between;align-items:center;">
          <div style="font-family:'Cormorant Garamond',serif;font-size:22px;color:var(--text-brown);font-weight:500;">TOTAL</div>
          <div style="font-family:'Cormorant Garamond',serif;font-size:28px;color:var(--brand-brown);font-weight:700;">${preorderData.total}</div>
        </div>
      `;
      
      const successPopup = document.getElementById('preorderSuccessPopup');
      const summaryElement = document.getElementById('preorderSummary');
      
      if (successPopup && summaryElement) {
        summaryElement.innerHTML = summaryHTML;
        successPopup.classList.add('active');
        console.log('Success popup should be visible now');
        closePopup();
      } else {
        console.error('Success popup elements not found');
        showNotification('Success', 'Preorder placed successfully!');
      }
    }

    function closePreorderSuccess() {
      document.getElementById('preorderSuccessPopup').classList.remove('active');
    }

    // Navigation Functions - GLOBAL
    function openSearch() {
      document.getElementById('searchModal').classList.add('active');
      document.getElementById('searchInput').focus();
    }

    function closeSearch() {
      document.getElementById('searchModal').classList.remove('active');
      document.getElementById('searchInput').value = '';
      document.getElementById('searchResults').innerHTML = '';
      document.getElementById('searchInput').blur();
    }

    function openAccount() {
      document.getElementById('accountModal').classList.add('active');
    }

    // Enhanced Search Functionality
      let allProductsData = [];
      
      function initializeSearchData() {
        // Load product data for search
        fetch('productdescription.json')
          .then(r => r.json())
          .then(data => {
            allProductsData = data;
            console.log('Search data loaded:', allProductsData.length, 'products');
          })
          .catch(err => {
            console.log('Failed to load search data:', err);
          });
      }
      
      function performSearch(event) {
        if (event && event.key === 'Enter') {
          event.preventDefault();
        }
        
        const searchTerm = document.getElementById('searchInput').value;
        const resultsContainer = document.getElementById('searchResults');
        
        if (!searchTerm || searchTerm.length < 2) {
          resultsContainer.innerHTML = '';
          return;
        }
        
        const results = searchProducts(searchTerm);
        displaySearchResults(results, searchTerm);
      }
      
      function searchProducts(searchTerm) {
        const term = searchTerm.toLowerCase().trim();
        const results = [];
        
        allProductsData.forEach(product => {
          let score = 0;
          let matches = [];
          
          // Search in bag name
          if (product.name && product.name.toLowerCase().includes(term)) {
            score += 10;
            matches.push('name');
          }
          
          // Search in description
          if (product.description && product.description.toLowerCase().includes(term)) {
            score += 5;
            matches.push('description');
          }
          
          // Search in category
          if (product.category && product.category.toLowerCase().includes(term)) {
            score += 8;
            matches.push('category');
          }
          
          // Search in bag type
          if (product.bagType && product.bagType.toLowerCase().includes(term)) {
            score += 6;
            matches.push('type');
          }
          
          // Search in colors
          if (product.availableColors) {
            product.availableColors.forEach(color => {
              if (color.toLowerCase().includes(term)) {
                score += 4;
                matches.push('color');
              }
            });
          }
          
          // Search in materials
          if (product.materialsAndFeatures && product.materialsAndFeatures.toLowerCase().includes(term)) {
            score += 3;
            matches.push('materials');
          }
          
          if (score > 0) {
            results.push({
              ...product,
              score: score,
              matches: matches
            });
          }
        });
        
        // Sort by relevance score
        return results.sort((a, b) => b.score - a.score);
      }
      
      function displaySearchResults(results, searchTerm) {
        const resultsContainer = document.getElementById('searchResults');
        
        if (results.length === 0) {
          resultsContainer.innerHTML = `
            <div class="search-no-results">
              <p>No results found for "${searchTerm}"</p>
              <p>Try searching for bag names, colors, or categories</p>
            </div>
          `;
          return;
        }
        
        const resultsHTML = results.slice(0, 6).map(product => {
          const key = keyFromDisplayNameGlobalSearch(product.name);
          const image = getImageForBag(key) || '';
          const price = formatPriceFor(key, product.price, 'search');
          
          return `
            <div class="search-result-item" onclick="goToProduct('${product.name}')">
              <div class="search-result-img" style="background-image:url('${image}')"></div>
              <div class="search-result-info">
                <h4>${product.name}</h4>
                <p class="search-result-desc">${formatSearchCardDescription(product.description, key)}</p>
                <div class="search-result-meta">
                  <span class="search-result-price">${price}</span>
                  <span class="search-result-category">${product.category}</span>
                </div>
              </div>
            </div>
          `;
        }).join('');
        
        const viewAllLink = results.length > 6 ? 
          `<div class="search-view-all">
            <a href="products.html?search=${encodeURIComponent(searchTerm)}" class="search-view-all-link">
              View all ${results.length} results →
            </a>
          </div>` : '';
        
        resultsContainer.innerHTML = `
          <div class="search-results-list">
            ${resultsHTML}
          </div>
          ${viewAllLink}
        `;
      }
      
      function goToProduct(productName) {
        // Close search modal and go to products page with product filter
        closeSearch();
        window.location.href = `products.html?search=${encodeURIComponent(productName)}`;
      }
      
      function getImageForBag(key) {
        // Use the same image mapping logic as products page
        const IMAGE_BY_KEY = {
          AINA: 'Aina_-_natural_w__black_vertical_lines_360x.webp',
          ALESSANDRA: 'Alessandra_when-worn_360x.webp',
          ALORA: 'AloraWashedBlue_Natural_360x.webp',
          AMPARO: 'Amparo_Yellow_360x.webp',
          AVA: 'Ava-JetBlack_360x.webp',
          BEATRIZ: 'BEATRIZ_-_black_600x.webp',
          BIANCA: 'BIANCA_Black_with_Choco_Brown_360x.webp',
          CAILA: 'Caila_black_V.2_1_360x.webp',
          CALLA: 'Calla_chocobrownwithnatural1_360x.webp',
          CAMILA: 'Camila_1_360x.webp',
          CARINA: 'CARINA_GREY_360x.webp',
          CARMELA: 'Calla_chocobrownwithnatural1_360x.webp',
          EVITA: 'Evita_gold_handbag.webp',
          FIESTA: 'FIESTA_gold_0dc52484-0ca1-4b84-9dff-f589a521126b_360x.webp',
          IVANNA: 'Ivanna-Limited-Gold_Black_Cream_360x.webp',
          KIARA: 'KIARA-_Choco_Brown_with_Natural_360x.webp',
          LUCIA: 'LuciaNatural_360x.webp',
          LUNA: 'LUNA-BLACK_360x.jpg',
          MARINA: 'Tara_jet_black_2_19587e5f-7400-41ed-9406-59b8001ede09_360x.webp',
          MARTINA: 'MARTINA_-_black_with_cream_360x.webp',
          MENSAJERA: 'MENSAJERA_when_worn_360x.webp',
          MONICA: 'Monica_-_natural_w__washed_blue_360x.webp',
          OLIVIA: 'OLIVIA-WHITE_360x.webp',
          PICCOLA: 'PICCOLA_-_GOLD_ef2ed91d-e249-456e-931c-c1bc5502b53b_600x.webp',
          RAFAELA: 'Mini_Rafaela_Blue_600x.webp',
          RAYA: 'RAYA_-_Crisscross_-_Black_with_Natural_360x.webp',
          SAMANTHA: 'Samantha_washed_brown_1_360x.webp',
          SAVANNAH: 'Savannah_blacknwhite_speckled_360x.webp',
          STELLA: 'STELLA_black_aa565e9c-71df-4274-8f55-e3c4112cd517_360x.webp',
          TARA: 'Tara_jet_black_2_19587e5f-7400-41ed-9406-59b8001ede09_360x.webp',
          VALENTIA: 'VALENTIA_2TONED_-_Gold_with_White_360x.webp',
          VICTORIA: 'Victoria_Grey_360x.jpg',
          VITTORIA: 'Vittoria-ChocoBrown_360x.webp',
          YARA: 'YARA_BLACK_360x.webp',
          ZARAH: 'Zarahwithsling.webp'
        };
        
        if (IMAGE_BY_KEY[key]) return IMAGE_BY_KEY[key];
        
        // Fallback images
        const fallbackImages = [
          'Aina_-_natural_w__black_vertical_lines_360x.webp',
          'BIANCA_Black_with_Choco_Brown_360x.webp',
          'LUNA-BLACK_360x.jpg',
          'PICCOLA_-_GOLD_ef2ed91d-e249-456e-931c-c1bc5502b53b_600x.webp',
          'STELLA_black_aa565e9c-71df-4274-8f55-e3c4112cd517_360x.webp'
        ];
        
        const hash = key.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
        return fallbackImages[hash % fallbackImages.length];
      }
      
      function formatPriceFor(key, price, section) {
        if (price && typeof price === 'string') {
          return price;
        }
        const num = parseInt(price) || 0;
        return num > 0 ? `₱${num.toLocaleString()}` : '₱0';
      }
      
      function formatSearchCardDescription(raw, key) {
        if (!raw) return '';
        const desc = String(raw).replace(/:contentReference\[[^\]]+\]\{[^\}]+\}/g, '').replace(/speranza/ig, 'SUKBIT').trim();
        return desc.length > 90 ? desc.substring(0, 87) + '...' : desc;
      }
      
      function keyFromDisplayNameGlobalSearch(name) {
        const cleaned = String(name || '').trim().replace(/\s+(II|III|IV|V|\d+)$/i, '');
        const parts = cleaned.split(/\s+/).filter(Boolean);
        if (parts.length === 0) return '';
        if (parts[0].toUpperCase() === 'MINI' && parts.length > 1) return parts[1].toUpperCase();
        if (parts[0].toUpperCase() === 'MAXI' && parts.length > 1) return parts[1].toUpperCase();
        return parts[0].toUpperCase();
      }
      
      function navigateToProduct(page, productName) {
        // Store the product name in sessionStorage for highlighting on the products page
        sessionStorage.setItem('searchedProduct', productName);
        window.location.href = page;
      }

      function searchByCategory(category) {
        const normalized = String(category || '').toLowerCase().trim();
        const normalizedCategory = (
          normalized === 'handbags' ? 'handbag' :
          normalized === 'bags' ? '' :
          normalized === 'shoulderbags' ? 'shoulder' :
          normalized === 'beadscollection' ? 'beads' :
          normalized
        );

        sessionStorage.setItem('searchedCategory', normalizedCategory);
        window.location.href = 'products.html';
      }

    function closeAccount() {
      document.getElementById('accountModal').classList.remove('active');
      document.getElementById('accountModal').querySelector('input').blur();
    }

    function switchAccountTab(tab, evt) {
      document.querySelectorAll('.account-tab').forEach(t => t.classList.remove('active'));
      if (evt && evt.target) evt.target.classList.add('active');
      
      document.querySelectorAll('.account-form').forEach(f => f.classList.remove('active'));
      document.getElementById(tab + 'Form').classList.add('active');
    }

    function handleLogin(event) {
      event.preventDefault();
      showNotification('Login', 'Thanks for logging in.');
      closeAccount();
    }

    function handleRegister(event) {
      event.preventDefault();
      showNotification('Registration', 'Thanks for registering.');
      closeAccount();
    }

    function handleNewsletterSubmit(event) {
      event.preventDefault();
      const email = event.target.querySelector('input[type="email"]').value;
      showNotification('Subscribed!', 'Thank you for subscribing with ' + email + '. You will receive our latest updates.');
      event.target.reset();
    }

    function showNotification(title, message) {
      const notification = document.createElement('div');
      notification.className = 'cart-notification';
      notification.innerHTML = `
        <div class="notification-content">
          <span class="notification-item">${title}</span>
        </div>
        <div class="notification-total">${message}</div>
      `;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentNode) {
          notification.parentNode.removeChild(notification);
        }
      }, 4000);
    }

    function showAccountLinks() {
      showNotification('Account', 'Account options will be available soon.');
    }

    function openCart() {
      document.getElementById('cartModal').classList.add('active');
      updateCartDisplay();
    }

    function closeCart() {
      document.getElementById('cartModal').classList.remove('active');
    }

    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // Initialize everything when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize search data
      initializeSearchData();
      
      const WEBP_FILES = [
        'Aina_-_natural_w__black_vertical_lines_360x.webp',
        'Alessandra_when-worn_360x.webp',
        'AloraWashedBlue_Natural_360x.webp',
        'Amparo_Yellow_360x.webp',
        'Ava-JetBlack_360x.webp',
        'BEATRIZ_-_black_600x.webp',
        'BIANCA_Black_with_Choco_Brown_360x.webp',
        'CARINA_GREY_360x.webp',
        'Caila_black_V.2_1_360x.webp',
        'Calla_chocobrownwithnatural1_360x.webp',
        'Camila_1_360x.webp',
        'Evita_gold_handbag.webp',
        'FIESTA_gold_0dc52484-0ca1-4b84-9dff-f589a521126b_360x.webp',
        'FullSizeRender_17bee014-fecc-4994-8efd-910d466f5d5d_360x.webp',
        'Ivanna-Limited-Gold_Black_Cream_360x.webp',
        'KIARA-_Choco_Brown_with_Natural_360x.webp',
        'LuciaNatural_360x.webp',
        'LUNA-BLACK_360x.jpg',
        'MARTINA_-_black_with_cream_360x.webp',
        'MENSAJERA_when_worn_360x.webp',
        'Mini_Rafaela_Blue_600x.webp',
        'MitaNaturalwithWashedBlue_360x.webp',
        'Monica_-_natural_w__washed_blue_360x.webp',
        'OLIVIA-WHITE_360x.webp',
        'PICCOLA_-_GOLD_ef2ed91d-e249-456e-931c-c1bc5502b53b_600x.webp',
        'RAYA_-_Crisscross_-_Black_with_Natural_360x.webp',
        'STELLA_black_aa565e9c-71df-4274-8f55-e3c4112cd517_360x.webp',
        'Samantha_washed_brown_1_360x.webp',
        'Savannah_blacknwhite_speckled_360x.webp',
        'Tara_jet_black_2_19587e5f-7400-41ed-9406-59b8001ede09_360x.webp',
        'VALENTIA_2TONED_-_Gold_with_White_360x.webp',
        'Vittoria-ChocoBrown_360x.webp',
        'YARA_BLACK_360x.webp',
        'Zarahwithsling_360x.webp',
        'BEATRIZ_-_black_360x.jpg',
        'Shoulder_Strap_for_Evita_Royal_Blue_360x.webp',
        'Victoria_Grey_360x.jpg',
        'washed_brown_with_choco_brown_no_sling_360x.webp',
        'Zarahwithsling.webp'
      ];

      const PRICE_OVERRIDE_BY_KEY = {
        AINA: 2700,
        BIANCA: 3900,
        LUNA: 2800,
        PICCOLA: 4500
      };

      function normalizeFilename(filename) {
        return filename.replace(/\s*\(\d+\)\s*/g, '').trim();
      }

      
      function inferNameFromFilename(filename) {
        let base = filename.replace(/\.[^.]+$/i, '');
        base = base.replace(/_\d+x$/i, '');
        base = base.replace(/_\d+x\b.*$/i, '');
        base = base.replace(/\bwhen[-_]?worn\b/ig, '');
        base = base.replace(/FullSizeRender_.*/i, 'FullSizeRender');
        base = base.replace(/withsling/ig, 'with sling');
        base = base.replace(/[_\-]+/g, ' ');
        base = base.replace(/\s+/g, ' ').trim();
        const parts = base.split(' ').filter(Boolean);
        if (parts.length === 0) return 'BAG';
        if (parts[0].toUpperCase() === 'MINI' && parts.length > 1) {
          return `${parts[0]} ${parts[1]}`.toUpperCase();
        }
        if (parts[0].toUpperCase() === 'FULLSIZERENDER') {
          return 'SIGNATURE';
        }
        if ((base || '').toLowerCase().includes('strap for evita')) {
          return 'EVITA STRAP';
        }
        if ((base || '').toLowerCase().startsWith('washed brown')) {
          return 'WASHED BROWN';
        }
        return parts[0].toUpperCase();
      }

      function inferColor(filename) {
        const f = filename.toLowerCase();
        if (f.includes('black')) return 'Black';
        if (f.includes('gold')) return 'Gold';
        if (f.includes('white')) return 'White';
        if (f.includes('grey') || f.includes('gray')) return 'Grey';
        if (f.includes('blue')) return 'Blue';
        if (f.includes('yellow')) return 'Yellow';
        if (f.includes('cream')) return 'Cream';
        if (f.includes('choco') || f.includes('brown')) return 'Brown';
        if (f.includes('natural')) return 'Natural';
        return 'Natural';
      }

      function inferSection(filename) {
        const f = filename.toLowerCase();
        if (f.includes('limited')) return 'limited';
        if (f.includes('fiesta')) return 'special';
        if (f.includes('fullsizerender')) return 'special';
        return 'hand';
      }

      function parsePriceToNumber(priceStr) {
        const s = String(priceStr || '');
        const m = s.match(/(\d[\d,]*)(?:\.(\d+))?/);
        if (!m) return 0;
        const whole = (m[1] || '').replace(/,/g, '');
        const n = parseInt(whole, 10);
        return Number.isFinite(n) ? n : 0;
      }

      function normalizePriceNumber(key, value, fallbackNumber) {
        const override = PRICE_OVERRIDE_BY_KEY[key];
        if (typeof override === 'number' && Number.isFinite(override) && override > 0) return override;

        const n = parsePriceToNumber(value);
        const base = n > 0 ? n : (Number.isFinite(fallbackNumber) ? fallbackNumber : 0);
        if (!base) return 0;
        return Math.min(base, 4500);
      }

      function formatPeso(n) {
        return '₱' + Number(n || 0).toLocaleString();
      }

      function keyFromDisplayName(name) {
        const cleaned = String(name || '').trim().replace(/\s+(II|III|IV|V|\d+)$/i, '');
        const parts = cleaned.split(/\s+/).filter(Boolean);
        if (parts.length === 0) return '';
        if (parts[0].toUpperCase() === 'MINI' && parts.length > 1) return parts[1].toUpperCase();
        if (parts[0].toUpperCase() === 'MAXI' && parts.length > 1) return parts[1].toUpperCase();
        return parts[0].toUpperCase();
      }

      function buildBagLookup(data) {
        const map = {};
        (Array.isArray(data) ? data : []).forEach(bag => {
          const n = String((bag && bag.name) || '').trim();
          const first = (n.split(/\s+/)[0] || '').toUpperCase();
          if (!first) return;
          if (!map[first]) {
            map[first] = bag;
            return;
          }
          if (first === 'RAFAELA') {
            const isMaxi = n.toUpperCase().includes('MAXI');
            const currentIsMaxi = String(map[first].name || '').toUpperCase().includes('MAXI');
            if (isMaxi && !currentIsMaxi) map[first] = bag;
          }
        });
        return map;
      }

      function defaultDescriptionFor(name, color) {
        const n = String(name || '').toUpperCase();
        if (n === 'AMPARO') return `AMPARO brings a bright pop of color with a clean, polished look—made for easy everyday styling.`;
        if (n === 'AVA') return `AVA is a sleek, modern essential designed to keep your day-to-night basics close in a refined silhouette.`;
        if (n === 'BEATRIZ') return `BEATRIZ is timeless and elevated—an effortless statement piece that pairs beautifully with any outfit.`;
        if (n.includes('STRAP')) return `Detachable accessory designed to pair perfectly with ${color} styles.`;
        return `A handcrafted standout in ${String(color || 'Natural').toLowerCase()} tones—easy to style, easy to carry, and made for everyday versatility.`;
      }

      function defaultPriceForSection(section) {
        if (section === 'limited') return '₱5,999';
        if (section === 'special') return '₱3,999';
        return '₱2,999';
      }

      function formatPriceFor(key, value, section) {
        const fallbackNumber = parsePriceToNumber(defaultPriceForSection(section));
        const n = normalizePriceNumber(key, value, fallbackNumber);
        return formatPeso(n);
      }

      function syncStaticOnHandFromJson(bagByKey) {
        if (!bagByKey) return;
        const handItems = document.querySelectorAll('#shopHandTrack .shop-item');
        handItems.forEach(item => {
          const nameEl = item.querySelector('h3');
          if (!nameEl) return;
          const displayName = (nameEl.textContent || '').trim().toUpperCase();
          const key = keyFromDisplayName(displayName);
          const bag = key && bagByKey[key] ? bagByKey[key] : null;
          if (!bag) return;

          const priceStr = formatPriceFor(key, bag.price, 'hand');
          const descText = formatCardDescription(bag.description, key);

          const p = item.querySelector('p');
          if (p && descText) p.textContent = descText;

          const priceEl = item.querySelector('.price');
          if (priceEl) priceEl.textContent = priceStr;

          const btn = item.querySelector('button.shop-btn');
          if (btn) btn.setAttribute('onclick', `showPurchasePopup('${displayName}', '${priceStr}')`);
        });
      }

      window.PRODUCT_IMAGE_MAP = window.PRODUCT_IMAGE_MAP || {};
      const seen = new Set();
      const uniqueFiles = [];
      WEBP_FILES.forEach(f => {
        const n = normalizeFilename(f);
        if (seen.has(n)) return;
        seen.add(n);
        uniqueFiles.push(n);
      });

      const usedFiles = new Set();
      Array.from(document.querySelectorAll('.product-img, .shop-img')).forEach(el => {
        const bg = (el && el.style && el.style.backgroundImage) ? el.style.backgroundImage : '';
        const m = bg.match(/url\('([^']+)'\)/i);
        if (!m) return;
        const file = normalizeFilename(m[1]);
        if (file && !file.startsWith('http')) usedFiles.add(file);
      });

      const onHandTrack = document.getElementById('shopHandTrack');
      const specialTrack = document.getElementById('shopSpecialTrack');
      const limitedTrack = document.getElementById('shopLimitedTrack');

      const MAX_ON_HAND = 8;
      const MIN_SPECIAL_FILL = 4;
      const MIN_LIMITED_FILL = 4;

      function hasExistingSlide(track, file) {
        if (!track) return false;
        // Check by product name instead of image to avoid duplicates
        const normalizedFile = normalizeFilename(file);
        const baseName = inferNameFromFilename(normalizedFile);
        const name = uniqueDisplayName(baseName);
        const existingNames = Array.from(track.querySelectorAll('.shop-item h3')).map(h => h.textContent.trim());
        return existingNames.includes(name);
      }

      function appendToTwoRowTrack(track, slideHTML) {
        if (!track) return;

        let col = track.lastElementChild;
        if (!col || !col.classList.contains('shop-col') || col.children.length >= 2) {
          col = document.createElement('div');
          col.className = 'shop-col';
          track.appendChild(col);
        }

        col.insertAdjacentHTML('beforeend', slideHTML);
      }

      function getTrackItemCount(track) {
        if (!track) return 0;
        return track.querySelectorAll('.shop-item h3').length;
      }

      let onHandCount = getTrackItemCount(onHandTrack);
      let specialCount = getTrackItemCount(specialTrack);
      let limitedCount = getTrackItemCount(limitedTrack);
      
      console.log('Initial track item counts:', {
        onHand: onHandCount,
        special: specialCount,
        limited: limitedCount
      });

      const nameCounts = {};
      function uniqueDisplayName(baseName) {
        const key = (baseName || '').trim().toUpperCase() || 'BAG';
        nameCounts[key] = (nameCounts[key] || 0) + 1;
        if (nameCounts[key] === 1) return key;
        const suffix = nameCounts[key] === 2 ? ' II' : ` ${nameCounts[key]}`;
        return key + suffix;
      }

      function chooseSectionForFile(file, hintedSection) {
        const f = file.toLowerCase();

        if (hintedSection === 'limited') return 'limited';
        if (hintedSection === 'special') return 'special';

        if (f.includes('gold')) {
          return limitedCount <= specialCount ? 'limited' : 'special';
        }

        if (specialCount < MIN_SPECIAL_FILL) return 'special';
        if (limitedCount < MIN_LIMITED_FILL) return 'limited';

        if (onHandCount < MAX_ON_HAND) return 'hand';
        return specialCount <= limitedCount ? 'special' : 'limited';
      }

      function populateFromFiles(bagByKey) {
        console.log('populateFromFiles called with', bagByKey ? 'JSON data' : 'null');
        console.log('uniqueFiles length:', uniqueFiles.length);
        console.log('Tracks found:', {
          onHand: !!onHandTrack,
          special: !!specialTrack,
          limited: !!limitedTrack
        });
        console.log('Initial counts:', {
          onHand: onHandCount,
          special: specialCount,
          limited: limitedCount
        });
        
        uniqueFiles.forEach((file, index) => {
          const normalized = normalizeFilename(file);
          console.log(`Processing file ${index}: ${file} -> ${normalized}`);
          
          const baseName = inferNameFromFilename(normalized);
          let name = uniqueDisplayName(baseName);
          const key = keyFromDisplayName(name);
          const color = inferColor(normalized);

          const hintedSection = inferSection(normalized);
          const finalSection = chooseSectionForFile(normalized, hintedSection);
          
          console.log(`Bag: ${name}, Section: ${finalSection}`);

          // Try to find the bag in JSON by key variations
          let bag = null;
          if (bagByKey) {
            // Try multiple key variations
            const keysToTry = [
              key,
              name.toUpperCase(),
              baseName.toUpperCase(),
              normalized.split('.')[0].toUpperCase(),
              normalized.split('_')[0].toUpperCase(),
              normalized.split('-')[0].toUpperCase()
            ];
            
            for (const tryKey of keysToTry) {
              if (bagByKey[tryKey]) {
                bag = bagByKey[tryKey];
                console.log(`Found bag with key: ${tryKey}`);
                break;
              }
            }
            
            // Also try searching by filename in bag names
            if (!bag) {
              for (const [jsonKey, jsonBag] of Object.entries(bagByKey)) {
                if (jsonBag.name && jsonBag.name.toLowerCase().includes(normalized.toLowerCase().split('.')[0])) {
                  bag = jsonBag;
                  console.log(`Found bag by name search: ${jsonKey} -> ${jsonBag.name}`);
                  break;
                }
              }
            }
          }
          
          // If we found a bag in JSON, use its actual name instead of filename-derived name
          if (bag && bag.name) {
            name = bag.name.split(/\s+/)[0]; // Use first word of actual bag name
            console.log(`Found bag in JSON: ${bag.name} -> using name: ${name}`);
          }

          const price = formatPriceFor(key, bag && bag.price, finalSection);

          const sectionLabel = finalSection === 'hand' ? 'On-hand' : (finalSection === 'special' ? 'Special offer' : 'Limited series');
          const omitMetaSuffix = new Set(['ALORA', 'ALORAWASHEDBLUE', 'AMPARO', 'AVA', 'BEATRIZ']);
          const fallbackDesc = omitMetaSuffix.has(String(key || '').toUpperCase())
            ? `${defaultDescriptionFor(name, color)}`
            : `${defaultDescriptionFor(name, color)} ${sectionLabel} • ${color}`;
          const descFull = bag && bag.description ? String(bag.description) : fallbackDesc;
          const desc = formatCardDescription(descFull, key);

          PRODUCT_IMAGE_MAP[name] = normalized;

          const slideHTML = `<div class="shop-slide"><div class="shop-item"><div class="shop-img" style="background-image:url('${normalized}');background-size:cover;background-position:center"></div><h3 class="cg-display">${name}</h3><p>${desc}</p><div class="price">${price}</div><button class="shop-btn" onclick="showPurchasePopup('${name}', '${price}')">PURCHASE</button></div></div>`;

          if (finalSection === 'limited' && limitedTrack) {
            console.log(`Trying to add ${name} to limited section...`);
            if (!hasExistingSlide(limitedTrack, normalized)) {
              limitedTrack.insertAdjacentHTML('beforeend', slideHTML);
              limitedCount++;
              console.log(`✓ Added ${name} to limited section (count: ${limitedCount})`);
            } else {
              console.log(`✗ ${name} already exists in limited section`);
            }
          } else if (finalSection === 'special' && specialTrack) {
            console.log(`Trying to add ${name} to special section...`);
            if (!hasExistingSlide(specialTrack, normalized)) {
              specialTrack.insertAdjacentHTML('beforeend', slideHTML);
              specialCount++;
              console.log(`✓ Added ${name} to special section (count: ${specialCount})`);
            } else {
              console.log(`✗ ${name} already exists in special section`);
            }
          } else if (finalSection === 'hand' && onHandTrack && onHandCount < MAX_ON_HAND) {
            console.log(`Trying to add ${name} to on-hand section...`);
            if (!hasExistingSlide(onHandTrack, normalized)) {
              if (onHandTrack.classList.contains('two-rows')) {
                appendToTwoRowTrack(onHandTrack, slideHTML);
              } else {
                onHandTrack.insertAdjacentHTML('beforeend', slideHTML);
              }
              onHandCount++;
              console.log(`✓ Added ${name} to on-hand section (count: ${onHandCount})`);
            } else {
              console.log(`✗ ${name} already exists in on-hand section`);
            }
          } else {
            console.log(`✗ Skipped ${name} - Section: ${finalSection}, onHandCount: ${onHandCount}, MAX_ON_HAND: ${MAX_ON_HAND}`);
          }
        });
        
        console.log('Final counts:', {
          onHand: onHandCount,
          special: specialCount,
          limited: limitedCount
        });
      }

      fetch('productdescription.json')
        .then(r => r.ok ? r.json() : Promise.reject(new Error('Failed to load JSON')))
        .then(data => {
          const lookup = buildBagLookup(data);
          window.BAG_LOOKUP = lookup;
          syncStaticOnHandFromJson(lookup);
          populateFromFiles(lookup);
        })
        .catch(() => populateFromFiles(null));

      // Carousel functionality
      function initCarousels() {
        // Categories carousel
        const categoriesWrapper = document.getElementById('categoriesWrapper');
        const categoriesTrack = document.getElementById('categoriesImages');
        if (categoriesWrapper && categoriesTrack) {
          const prevBtn = categoriesWrapper.querySelector('[data-role="prev"]');
          const nextBtn = categoriesWrapper.querySelector('[data-role="next"]');
          const slides = Array.from(categoriesTrack.children);
          
          let currentIndex = 0;
          const slidesToShow = window.innerWidth < 768 ? 1 : 2;
          
          function updateCarousel() {
            const slideWidth = slides[0].offsetWidth;
            const gap = 28;
            const offset = currentIndex * (slideWidth + gap);
            categoriesTrack.style.transform = `translateX(-${offset}px)`;
            
            if (prevBtn) prevBtn.disabled = currentIndex <= 0;
            if (nextBtn) nextBtn.disabled = currentIndex >= slides.length - slidesToShow;
          }
          
          if (prevBtn) prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
              currentIndex--;
              updateCarousel();
            }
          });
          
          if (nextBtn) nextBtn.addEventListener('click', () => {
            if (currentIndex < slides.length - slidesToShow) {
              currentIndex++;
              updateCarousel();
            }
          });
          
          setTimeout(updateCarousel, 100);
        }

        // Shop carousels - FIX FOR PAGE 2, 3 BUTTONS
        const shopSections = ['shop-hand', 'shop-special', 'shop-limited'];
        
        shopSections.forEach(sectionId => {
          const section = document.querySelector(`.${sectionId}`);
          if (!section) return;
          
          const wrapper = section.querySelector('.shop-carousel-wrapper');
          const track = section.querySelector('.shop-carousel-track');
          if (!wrapper || !track) return;
          
          const prevBtn = wrapper.querySelector('[data-role="prev"]');
          const nextBtn = wrapper.querySelector('[data-role="next"]');
          const slides = Array.from(track.children);
          
          let currentIndex = 0;
          const slidesToShow = window.innerWidth < 768 ? 1 : (window.innerWidth < 1024 ? 2 : 4);
          
          function updateCarousel() {
            const slideWidth = slides[0].offsetWidth;
            const gap = 35;
            const offset = currentIndex * (slideWidth + gap);
            track.style.transform = `translateX(-${offset}px)`;
            
            if (prevBtn) prevBtn.disabled = currentIndex <= 0;
            if (nextBtn) nextBtn.disabled = currentIndex >= slides.length - slidesToShow;
          }
          
          if (prevBtn) prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
              currentIndex--;
              updateCarousel();
            }
          });
          
          if (nextBtn) nextBtn.addEventListener('click', () => {
            if (currentIndex < slides.length - slidesToShow) {
              currentIndex++;
              updateCarousel();
            }
          });
          
          setTimeout(updateCarousel, 100);
          
          window.addEventListener('resize', () => {
            currentIndex = 0;
            setTimeout(updateCarousel, 100);
          });
        });

        // Reviews carousel
        const reviewsCarousel = document.getElementById('reviewsCarousel');
        if (reviewsCarousel) {
          const prevBtn = reviewsCarousel.querySelector('[data-role="prev"]');
          const nextBtn = reviewsCarousel.querySelector('[data-role="next"]');
          const reviewsList = document.getElementById('reviewsList');
          const reviewsDots = document.getElementById('reviewsDots');
          
          if (prevBtn && nextBtn && reviewsList && reviewsDots) {
            const slides = Array.from(reviewsList.children);
            let currentIndex = 0;
            
            function updateReviewsCarousel() {
              const slideWidth = slides[0].offsetWidth;
              const gap = 24;
              const offset = currentIndex * (slideWidth + gap);
              reviewsList.style.transform = `translateX(-${offset}px)`;
              
              // Update dots
              reviewsDots.innerHTML = '';
              slides.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'reviews-dot';
                if (index === currentIndex) dot.classList.add('active');
                dot.addEventListener('click', () => {
                  currentIndex = index;
                  updateReviewsCarousel();
                });
                reviewsDots.appendChild(dot);
              });
              
              // Update button states
              prevBtn.disabled = currentIndex <= 0;
              nextBtn.disabled = currentIndex >= slides.length - 1;
            }
            
            if (prevBtn) prevBtn.addEventListener('click', () => {
              if (currentIndex > 0) {
                currentIndex--;
                updateReviewsCarousel();
              }
            });
            
            if (nextBtn) nextBtn.addEventListener('click', () => {
              if (currentIndex < slides.length - 1) {
                currentIndex++;
                updateReviewsCarousel();
              }
            });
            
            // Initialize
            setTimeout(updateReviewsCarousel, 100);
            
            // Handle window resize
            window.addEventListener('resize', () => {
              currentIndex = 0;
              setTimeout(updateReviewsCarousel, 100);
            });
          }
        }
      }

      initCarousels();

      // Initialize cart display on page load
      updateCartDisplay();

      // Modal close handlers
      document.getElementById('preorderPopup').addEventListener('click', function(e) {
        if (e.target === this) {
          closePopup();
        }
      });

      document.getElementById('searchModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeSearch();
        }
      });

      document.getElementById('accountModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeAccount();
        }
      });

      document.getElementById('cartModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeCart();
        }
      });

      // Review modal backdrop click handler
      document.getElementById('reviewModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeReviewModal();
        }
      });

      // Review form submit handler
      const reviewForm = document.querySelector('.review-form');
      if (reviewForm) {
        reviewForm.addEventListener('submit', submitReview);
      }

      // Preorder success popup backdrop click handler
      document.getElementById('preorderSuccessPopup').addEventListener('click', function(e) {
        if (e.target === this) {
          closePreorderSuccess();
        }
      });

      // Escape key handler
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          if (document.getElementById('preorderPopup').classList.contains('active')) {
            closePopup();
          }
          if (document.getElementById('searchModal').classList.contains('active')) {
            closeSearch();
          }
          if (document.getElementById('accountModal').classList.contains('active')) {
            closeAccount();
          }
          if (document.getElementById('cartModal').classList.contains('active')) {
            closeCart();
          }
          if (document.getElementById('reviewModal').classList.contains('active')) {
            closeReviewModal();
          }
          if (document.getElementById('preorderSuccessPopup').classList.contains('active')) {
            closePreorderSuccess();
          }
        }
      });

      // Back to top button
      window.addEventListener('scroll', function() {
        const backToTop = document.querySelector('.back-to-top');
        if (window.pageYOffset > 300) {
          backToTop.classList.add('show');
        } else {
          backToTop.classList.remove('show');
        }
      });
    });
  </script>

  <script>
    // Review Modal Functions (Global Scope)
    function openReviewModal() {
      document.getElementById('reviewModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeReviewModal() {
      document.getElementById('reviewModal').classList.remove('active');
      document.body.style.overflow = '';
      // Reset form
      const form = document.querySelector('.review-form');
      if (form) form.reset();
      // Reset stars
      const stars = document.querySelectorAll('.review-star');
      stars.forEach(star => star.classList.remove('selected'));
    }

    function setRating(rating) {
      const stars = document.querySelectorAll('.review-star');
      stars.forEach((star, index) => {
        if (index < rating) {
          star.classList.add('selected');
        } else {
          star.classList.remove('selected');
        }
      });
    }

    function submitReview(event) {
      event.preventDefault();
      
      const formData = new FormData(event.target);
      const name = formData.get('name') || document.querySelector('.review-form input[type="text"]').value;
      const email = formData.get('email') || document.querySelector('.review-form input[type="email"]').value;
      const review = formData.get('review') || document.querySelector('.review-form textarea').value;
      const rating = document.querySelectorAll('.review-star.selected').length;
      
      if (!name || !email || !review || rating === 0) {
        showNotification('Error', 'Please fill in all fields and select a rating');
        return;
      }
      
      // Create new review element
      const reviewsList = document.getElementById('reviewsList');
      const newReview = document.createElement('div');
      newReview.className = 'review-slide';
      newReview.innerHTML = `
        <div class="review-card">
          <div class="review-avatar" style="background-image:url('https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=80&h=80&fit=crop');background-size:cover;background-position:center;border-radius:50%"></div>
          <div class="review-rating">${'★'.repeat(rating)}${'☆'.repeat(5-rating)}</div>
          <div class="review-name">${name}</div>
          <div class="review-line"></div>
          <div class="review-text">"${review}"</div>
          <div class="review-date">Just now</div>
          <div class="review-verified">Verified Buyer</div>
        </div>
      `;
      
      // Add to beginning of reviews list
      reviewsList.insertBefore(newReview, reviewsList.firstChild);
      
      // Refresh carousel to include new review
      const reviewsCarousel = document.getElementById('reviewsCarousel');
      if (reviewsCarousel) {
        const prevBtn = reviewsCarousel.querySelector('[data-role="prev"]');
        const nextBtn = reviewsCarousel.querySelector('[data-role="next"]');
        const reviewsDots = document.getElementById('reviewsDots');
        
        if (prevBtn && nextBtn && reviewsDots) {
          const slides = Array.from(reviewsList.children);
          let currentIndex = 0;
          
          function updateReviewsCarousel() {
            const slideWidth = slides[0].offsetWidth;
            const gap = 24;
            const offset = currentIndex * (slideWidth + gap);
            reviewsList.style.transform = `translateX(-${offset}px)`;
            
            // Update dots
            reviewsDots.innerHTML = '';
            slides.forEach((_, index) => {
              const dot = document.createElement('div');
              dot.className = 'reviews-dot';
              if (index === currentIndex) dot.classList.add('active');
              dot.addEventListener('click', () => {
                currentIndex = index;
                updateReviewsCarousel();
              });
              reviewsDots.appendChild(dot);
            });
            
            // Update button states
            prevBtn.disabled = currentIndex <= 0;
            nextBtn.disabled = currentIndex >= slides.length - 1;
          }
          
          // Re-attach event listeners
          prevBtn.onclick = () => {
            if (currentIndex > 0) {
              currentIndex--;
              updateReviewsCarousel();
            }
          };
          
          nextBtn.onclick = () => {
            if (currentIndex < slides.length - 1) {
              currentIndex++;
              updateReviewsCarousel();
            }
          };
          
          // Initialize with new review
          setTimeout(updateReviewsCarousel, 100);
        }
      }
      
      // Show success message
      showNotification('Thank You!', 'Your review has been submitted successfully.');
      
      // Close modal and reset form
      closeReviewModal();
    }
  </script>
</body>
</html>